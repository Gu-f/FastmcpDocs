---
title: FastMCP CLI
sidebarTitle: CLI
description: 学习如何使用 FastMCP 命令行界面
icon: terminal
---

import { VersionBadge } from "/snippets/version-badge.mdx"


FastMCP 提供了一个命令行界面（CLI），使您能够轻松运行、开发和安装 MCP 服务器。CLI 在您安装 FastMCP 时会自动安装。

```bash
fastmcp --help
```

## 命令概览

| 命令 | 用途 | 依赖管理 |
| ------- | ------- | --------------------- |
| `run` | 直接运行 FastMCP 服务器 | **支持：** 本地文件、工厂函数、URL、MCP 配置。**依赖：** 直接使用您的本地环境。使用 `--python`、`--with`、`--project` 或 `--with-requirements` 参数时：通过 `uv run` 子进程运行 |
| `dev` | 使用 MCP Inspector 运行服务器进行测试 | **支持：** 仅本地文件。**依赖：** 始终通过 `uv run` 子进程运行（从不使用您的本地环境）；必须指定依赖或在 uv 管理的项目中可用 |
| `install` | 在 MCP 客户端应用程序中安装服务器 | **支持：** 仅本地文件。**依赖：** 创建隔离环境；必须使用 `--with` 和/或 `--with-editable` 明确指定依赖 |
| `inspect` | 生成关于 FastMCP 服务器的 JSON 报告 | **支持：** 仅本地文件。**依赖：** 使用您当前的环境；您需要负责确保所有依赖都可用 |
| `project prepare` | Create a persistent uv project from fastmcp.json environment config | **Supports:** fastmcp.json configs only. **Deps:** Creates a uv project directory with all dependencies pre-installed for reuse with `--project` flag |
| `version` | 显示版本信息 | N/A |

## `fastmcp run`

直接运行 FastMCP 服务器或代理远程服务器。

```bash
fastmcp run server.py
```

<Tip>
默认情况下，此命令在您当前的 Python 环境中直接运行服务器。您需要负责确保所有依赖都可用。当使用 `--python`、`--with`、`--project` 或 `--with-requirements` 选项时，它将通过 `uv run` 子进程运行服务器。
</Tip>

### 选项

| 选项 | 标志 | 描述 |
| ------ | ---- | ----------- |
| 传输协议 | `--transport`, `-t` | 使用的传输协议（`stdio`、`http` 或 `sse`） |
| 主机 | `--host` | 使用 http 传输时绑定的主机（默认：127.0.0.1） |
| 端口 | `--port`, `-p` | 使用 http 传输时绑定的端口（默认：8000） |
| 路径 | `--path` | 使用 http 传输时绑定的路径（默认：`/mcp/` 或 SSE 为 `/sse/`） |
| 日志级别 | `--log-level`, `-l` | 日志级别（DEBUG、INFO、WARNING、ERROR、CRITICAL） |
| 无横幅 | `--no-banner` | 禁用启动横幅显示 |
| No Environment | `--skip-env` | Skip environment setup with uv (use when already in a uv environment) |
| Python 版本 | `--python` | 使用的 Python 版本（例如 3.10、3.11） |
| 附加包 | `--with` | 要安装的附加包（可多次使用） |
| 项目目录 | `--project` | 在给定项目目录中运行命令 |
| 需求文件 | `--with-requirements` | 用于安装依赖的需求文件 |


### 入口点
<VersionBadge version="2.3.5" />

`fastmcp run` 命令支持以下入口点：

1. **[Inferred server instance](#inferred-server-instance)**: `server.py` - imports the module and looks for a FastMCP server instance named `mcp`, `server`, or `app`. Errors if no such object is found.
2. **[Explicit server entrypoint](#explicit-server-entrypoint)**: `server.py:custom_name` - imports and uses the specified server entrypoint
3. **[Factory function](#factory-function)**: `server.py:create_server` - calls the specified function (sync or async) to create a server instance
4. **[Remote server proxy](#remote-server-proxy)**: `https://example.com/mcp-server` - connects to a remote server and creates a **local proxy server**
5. **[FastMCP configuration file](#fastmcp-configuration)**: `fastmcp.json` - runs servers using FastMCP's declarative configuration format (auto-detects files in current directory)
6. **MCP configuration file**: `mcp.json` - runs servers defined in a standard MCP configuration file

<Warning>
注意：当使用 `fastmcp run` 运行本地文件时，它会**完全忽略** `if __name__ == "__main__"` 代码块。这意味着：
- `__main__` 中的任何设置代码都不会运行
- `__main__` 中的服务器配置被绕过  
- `fastmcp run` finds your server entrypoint/factory and runs it with its own transport settings

如果您需要运行设置代码，请使用**工厂模式**。
</Warning>

#### 推断服务器实例

如果您提供文件路径，`fastmcp run` 将加载文件并查找存储为名为 `mcp`、`server` 或 `app` 变量的 FastMCP 服务器实例。如果未找到此类对象，将引发错误。

例如，如果您有一个名为 `server.py` 的文件，内容如下：

```python server.py
from fastmcp import FastMCP

mcp = FastMCP("MyServer")
```

您可以运行它：

```bash
fastmcp run server.py
```

#### Explicit Server Entrypoint

If your server is stored as a variable with a custom name, or you want to be explicit about which server to run, you can use the following syntax to load a specific server entrypoint:

```bash
fastmcp run server.py:custom_name
```

例如，如果您有一个名为 `server.py` 的文件，内容如下：

```python
from fastmcp import FastMCP

my_server = FastMCP("CustomServer")

@my_server.tool
def hello() -> str:
    return "Hello from custom server!"
```

您可以运行它：

```bash
fastmcp run server.py:my_server
```

#### 工厂函数
<VersionBadge version="2.11.2" />

由于 `fastmcp run` 忽略 `if __name__ == "__main__"` 代码块，您可以使用工厂函数在服务器启动前运行设置代码。工厂函数不带任何参数调用，必须返回 FastMCP 服务器实例。支持同步和异步工厂函数。

The syntax for using a factory function is the same as for an explicit server entrypoint: `fastmcp run server.py:factory_fn`. FastMCP will automatically detect that you have identified a function rather than a server Instance

例如，如果您有一个名为 `server.py` 的文件，内容如下：

```python
from fastmcp import FastMCP

async def create_server() -> FastMCP:
    mcp = FastMCP("MyServer")
    
    @mcp.tool
    def add(x: int, y: int) -> int:
        return x + y
    
    # 与 fastmcp run 一起运行的设置
    tool = await mcp.get_tool("add")
    tool.disable()
    
    return mcp
```

您可以运行它：

```bash
fastmcp run server.py:create_server
```

#### 远程服务器代理

FastMCP run 还可以启动连接到远程服务器的本地代理服务器。当您想要在本地运行远程服务器进行测试或开发，或与不支持直接连接远程服务器的客户端一起使用时，这很有用。

要启动本地代理，您可以使用以下语法：

```bash
fastmcp run https://example.com/mcp
```

#### FastMCP Configuration
<VersionBadge version="2.11.4" />

FastMCP supports declarative configuration through `fastmcp.json` files. When you run `fastmcp run` without arguments, it automatically looks for a `fastmcp.json` file in the current directory:

```bash
# Auto-detect fastmcp.json in current directory
fastmcp run

# Or explicitly specify a configuration file
fastmcp run my-config.fastmcp.json
```

The configuration file handles dependencies, environment variables, and transport settings. Command-line arguments override configuration file values:

```bash
# Override port from config file
fastmcp run fastmcp.json --port 8080

# Skip environment setup when already in a uv environment
fastmcp run fastmcp.json --skip-env
```

<Note>
The `--skip-env` flag is useful when:
- You're already in an activated virtual environment
- You're inside a Docker container with pre-installed dependencies
- You're in a uv-managed environment (prevents infinite recursion)
- You want to test the server without environment setup
</Note>

See [Server Configuration](/zh/deployment/server-configuration) for detailed documentation on fastmcp.json.

#### MCP Configuration

FastMCP can also run servers defined in a standard MCP configuration file. This is useful when you want to run multiple servers from a single file, or when you want to use a client that doesn't support direct connections to remote servers.

To run a MCP configuration file, you can use the following syntax:

```bash
fastmcp run mcp.json
```

This will run all the servers defined in the file.

## `fastmcp dev`

Run a MCP server with the [MCP Inspector](https://github.com/modelcontextprotocol/inspector) for testing.

```bash
fastmcp dev server.py
```

<Tip>
This command always runs your server via `uv run` subprocess (never your local environment) to work with the MCP Inspector. Dependencies can be:
- Specified using `--with` and/or `--with-editable` options
- Defined in a `fastmcp.json` configuration file
- Available in a uv-managed project

When using `fastmcp.json`, the dev command automatically uses the configured dependencies.
</Tip>

<Warning>
`dev` 命令是仅通过 STDIO 测试服务器的快捷方式。当 Inspector 启动时，您可能需要：
1. 从传输下拉菜单中选择 "STDIO"
2. 手动连接

此命令不支持 HTTP 测试。要通过 Streamable HTTP 或 SSE 测试服务器：
1. 使用命令行手动启动具有适当传输的服务器：
   ```bash
   fastmcp run server.py --transport http
   ```
   或通过在代码中设置传输：
   ```bash
   python server.py  # 假设您的 __main__ 代码块设置了 Streamable HTTP 传输
   ```
2. 单独打开 MCP Inspector 并连接到正在运行的服务器
</Warning>

### 选项

| 选项 | 标志 | 描述 |
| ------ | ---- | ----------- |
| 可编辑包 | `--with-editable`, `-e` | 包含 pyproject.toml 的目录，以可编辑模式安装 |
| 附加包 | `--with` | 要安装的附加包（可多次使用） |
| Inspector 版本 | `--inspector-version` | 使用的 MCP Inspector 版本 |
| UI 端口 | `--ui-port` | MCP Inspector UI 的端口 |
| 服务器端口 | `--server-port` | MCP Inspector 代理服务器的端口 |
| Python 版本 | `--python` | 使用的 Python 版本（例如 3.10、3.11） |
| 项目目录 | `--project` | 在给定项目目录中运行命令 |
| 需求文件 | `--with-requirements` | 用于安装依赖的需求文件 |

### 入口点

`dev` 命令仅支持本地 FastMCP 服务器文件：

1. **Inferred server instance**: `server.py` - imports the module and looks for a FastMCP server instance named `mcp`, `server`, or `app`. Errors if no such object is found.
2. **Explicit server entrypoint**: `server.py:custom_name` - imports and uses the specified server entrypoint
3. **Factory function**: `server.py:create_server` - calls the specified function (sync or async) to create a server instance
4. **FastMCP configuration**: `fastmcp.json` - uses FastMCP's declarative configuration (auto-detects in current directory)

<Warning>
`dev` 命令**仅支持本地文件** - 不支持 URL、远程服务器或 MCP 配置文件。
</Warning>

**示例**

```bash
# Run dev server with editable mode and additional packages
fastmcp dev server.py -e . --with pandas --with matplotlib

# Run dev server with fastmcp.json configuration (auto-detects)
fastmcp dev

# Run dev server with explicit fastmcp.json file
fastmcp dev dev.fastmcp.json

# Run dev server with specific Python version
fastmcp dev server.py --python 3.11

# Run dev server with requirements file
fastmcp dev server.py --with-requirements requirements.txt

# Run dev server within a specific project directory
fastmcp dev server.py --project /path/to/project
```

## `fastmcp install`
<VersionBadge version="2.10.3" />

Install a MCP server in MCP client applications. FastMCP currently supports the following clients:

- **Claude Code** - Installs via Claude Code's built-in MCP management system
- **Claude Desktop** - Installs via direct configuration file modification
- **Cursor** - Installs via deeplink that opens Cursor for user confirmation
- **MCP JSON** - Generates standard MCP JSON configuration for manual use

```bash
fastmcp install claude-code server.py
fastmcp install claude-desktop server.py
fastmcp install cursor server.py
fastmcp install mcp-json server.py
```

Note that for security reasons, MCP clients usually run every server in a completely isolated environment. Therefore, all dependencies must be explicitly specified using the `--with` and/or `--with-editable` options (following `uv` conventions) or by attaching them to your server in code via the `dependencies` parameter. You should not assume that the MCP server will have access to your local environment.

<Warning>
**`uv` must be installed and available in your system PATH**. Both Claude Desktop and Cursor run in isolated environments and need `uv` to manage dependencies. On macOS, install `uv` globally with Homebrew for Claude Desktop compatibility: `brew install uv`.
</Warning>

<Note>
**Python Version Considerations**: The install commands now support the `--python` option to specify a Python version directly. You can also use `--project` to run within a specific project directory or `--with-requirements` to install dependencies from a requirements file.
</Note>

<Tip>
**FastMCP `install` commands focus on local server files with STDIO transport.** For remote servers running with HTTP or SSE transport, use your client's native configuration - FastMCP's value is simplifying the complex local setup with dependencies and `uv` commands.
</Tip>

### Options

| Option | Flag | Description |
| ------ | ---- | ----------- |
| Server Name | `--server-name`, `-n` | Custom name for the server (defaults to server's name attribute or file name) |
| Editable Package | `--with-editable`, `-e` | Directory containing pyproject.toml to install in editable mode |
| Additional Packages | `--with` | Additional packages to install (can be used multiple times) |
| Environment Variables | `--env` | Environment variables in KEY=VALUE format (can be used multiple times) |
| Environment File | `--env-file`, `-f` | Load environment variables from a .env file |
| Python Version | `--python` | Python version to use (e.g., 3.10, 3.11) |
| Project Directory | `--project` | Run the command within the given project directory |
| Requirements File | `--with-requirements` | Requirements file to install dependencies from |

### Entrypoints

The `install` command supports local FastMCP server files and configuration:

1. **Inferred server instance**: `server.py` - imports the module and looks for a FastMCP server instance named `mcp`, `server`, or `app`. Errors if no such object is found.
2. **Explicit server entrypoint**: `server.py:custom_name` - imports and uses the specified server entrypoint
3. **Factory function**: `server.py:create_server` - calls the specified function (sync or async) to create a server instance
4. **FastMCP configuration**: `fastmcp.json` - uses FastMCP's declarative configuration with dependencies and settings

<Note>
Factory functions are particularly useful for install commands since they allow setup code to run that would otherwise be ignored when the MCP client runs your server. When using fastmcp.json, dependencies are automatically handled.
</Note>

<Warning>
The `install` command **only supports local files and fastmcp.json** - no URLs, remote servers, or standard MCP configuration files. For remote servers, use your MCP client's native configuration.
</Warning>

**Examples**

```bash
# Auto-detects server entrypoint (looks for 'mcp', 'server', or 'app')
fastmcp install claude-desktop server.py

# Install with fastmcp.json configuration (auto-detects)
fastmcp install claude-desktop

# Install with explicit fastmcp.json file
fastmcp install claude-desktop my-config.fastmcp.json

# Uses specific server entrypoint
fastmcp install claude-desktop server.py:my_server

# With custom name and dependencies
fastmcp install claude-desktop server.py:my_server --server-name "My Analysis Server" --with pandas

# Install in Claude Code with environment variables
fastmcp install claude-code server.py --env API_KEY=secret --env DEBUG=true

# Install in Cursor with environment variables
fastmcp install cursor server.py --env API_KEY=secret --env DEBUG=true

# Install with environment file
fastmcp install cursor server.py --env-file .env

# Install with specific Python version
fastmcp install claude-desktop server.py --python 3.11

# Install with requirements file
fastmcp install claude-code server.py --with-requirements requirements.txt

# Install within a project directory
fastmcp install cursor server.py --project /path/to/project

# Generate MCP JSON configuration
fastmcp install mcp-json server.py --name "My Server" --with pandas

# Copy JSON configuration to clipboard
fastmcp install mcp-json server.py --copy
```

### MCP JSON Generation

The `mcp-json` subcommand generates standard MCP JSON configuration that can be used with any MCP-compatible client. This is useful when:

- Working with MCP clients not directly supported by FastMCP
- Creating configuration for CI/CD environments
- Sharing server configurations with others
- Integration with custom tooling

The generated JSON follows the standard MCP server configuration format used by Claude Desktop, VS Code, Cursor, and other MCP clients, with the server name as the root key:

```json
{
  "server-name": {
    "command": "uv",
    "args": [
      "run",
      "--with",
      "fastmcp",
      "fastmcp",
      "run",
      "/path/to/server.py"
    ],
    "env": {
      "API_KEY": "value"
    }
  }
}
```

<Note>
To use this configuration with your MCP client, you'll typically need to add it to the client's `mcpServers` object. Consult your client's documentation for any specific configuration requirements or formatting needs.
</Note>

**Options specific to mcp-json:**

| Option | Flag | Description |
| ------ | ---- | ----------- |
| Copy to Clipboard | `--copy` | Copy configuration to clipboard instead of printing to stdout |

## `fastmcp inspect`

<VersionBadge version="2.9.0" />

Inspect a FastMCP server to view summary information or generate a detailed JSON report.

```bash
# Show text summary
fastmcp inspect server.py

# Output FastMCP JSON to stdout
fastmcp inspect server.py --format fastmcp

# Save MCP JSON to file (format required with -o)
fastmcp inspect server.py --format mcp -o manifest.json
```

### Options

| Option | Flag | Description |
| ------ | ---- | ----------- |
| Format | `--format`, `-f` | Output format: `fastmcp` (FastMCP-specific) or `mcp` (MCP protocol). Required when using `-o` |
| Output File | `--output`, `-o` | Save JSON report to file instead of stdout. Requires `--format` |

### Output Formats

#### FastMCP Format (`--format fastmcp`)
The default and most comprehensive format, includes all FastMCP-specific metadata:
- Server name, instructions, and version
- FastMCP version and MCP version
- Tool tags and enabled status
- Output schemas for tools
- Annotations and custom metadata
- Uses snake_case field names
- **Use this for**: Complete server introspection and debugging FastMCP servers

#### MCP Protocol Format (`--format mcp`)
Shows exactly what MCP clients will see via the protocol:
- Only includes standard MCP protocol fields
- Matches output from `client.list_tools()`, `client.list_prompts()`, etc.
- Uses camelCase field names (e.g., `inputSchema`)
- Excludes FastMCP-specific fields like tags and enabled status
- **Use this for**: Debugging client visibility and ensuring MCP compatibility

### Entrypoints

The `inspect` command supports local FastMCP server files and configuration:

1. **Inferred server instance**: `server.py` - imports the module and looks for a FastMCP server instance named `mcp`, `server`, or `app`. Errors if no such object is found.
2. **Explicit server entrypoint**: `server.py:custom_name` - imports and uses the specified server entrypoint
3. **Factory function**: `server.py:create_server` - calls the specified function (sync or async) to create a server instance
4. **FastMCP configuration**: `fastmcp.json` - inspects servers defined with FastMCP's declarative configuration

<Warning>
The `inspect` command **only supports local files and fastmcp.json** - no URLs, remote servers, or standard MCP configuration files.
</Warning>

### Examples

```bash
# Show text summary (no JSON output)
fastmcp inspect server.py
# Output:
# Server: MyServer
# Instructions: A helpful MCP server
# Version: 1.0.0
#
# Components:
#   Tools: 5
#   Prompts: 2
#   Resources: 3
#   Templates: 1
#
# Environment:
#   FastMCP: 2.0.0
#   MCP: 1.0.0
#
# Use --format [fastmcp|mcp] for complete JSON output

# Output FastMCP format to stdout
fastmcp inspect server.py --format fastmcp

# Specify server entrypoint
fastmcp inspect server.py:my_server

# Output MCP protocol format to stdout
fastmcp inspect server.py --format mcp

# Save to file (format required)
fastmcp inspect server.py --format fastmcp -o server-manifest.json

# Save MCP format with custom server object
fastmcp inspect server.py:my_server --format mcp -o mcp-manifest.json

# Error: format required with output file
fastmcp inspect server.py -o output.json
# Error: --format is required when using -o/--output
```

## `fastmcp project prepare`

Create a persistent uv project directory from a fastmcp.json file's environment configuration. This allows you to pre-install all dependencies once and reuse them with the `--project` flag.

```bash
fastmcp project prepare fastmcp.json --output-dir ./env
```

### Options

| Option | Flag | Description |
| ------ | ---- | ----------- |
| Output Directory | `--output-dir` | **Required.** Directory where the persistent uv project will be created |

### Usage Pattern

```bash
# Step 1: Prepare the environment (installs dependencies)
fastmcp project prepare fastmcp.json --output-dir ./my-env

# Step 2: Run using the prepared environment (fast, no dependency installation)
fastmcp run fastmcp.json --project ./my-env
```

The prepare command creates a uv project with:
- A `pyproject.toml` containing all dependencies from the fastmcp.json
- A `.venv` with all packages pre-installed
- A `uv.lock` file for reproducible environments

This is useful when you want to separate environment setup from server execution, such as in deployment scenarios where dependencies are installed once and the server is run multiple times.

## `fastmcp version`

Display version information about FastMCP and related components.

```bash
fastmcp version
```

### Options

| Option | Flag | Description |
| ------ | ---- | ----------- |
| Copy to Clipboard | `--copy` | Copy version information to clipboard |
