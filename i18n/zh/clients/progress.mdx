---
title: 进度监控
sidebarTitle: 进度
description: 处理来自长时间运行的服务器操作的进度通知。
icon: bars-progress
---

import { VersionBadge } from '/snippets/version-badge.mdx'

<VersionBadge version="2.3.5" />

MCP 服务器可以在长时间运行的操作期间报告进度。客户端可以通过进度处理程序接收这些更新。

## 进度处理程序

在创建客户端时设置进度处理程序：

```python
from fastmcp import Client

async def my_progress_handler(
    progress: float, 
    total: float | None, 
    message: str | None
) -> None:
    if total is not None:
        percentage = (progress / total) * 100
        print(f"进度: {percentage:.1f}% - {message or ''}")
    else:
        print(f"进度: {progress} - {message or ''}")

client = Client(
    "my_mcp_server.py",
    progress_handler=my_progress_handler
)
```

### 处理程序参数

进度处理程序接收三个参数：


<Card icon="code" title="进度处理程序参数">
<ResponseField name="progress" type="float">
  当前进度值
</ResponseField>

<ResponseField name="total" type="float | None">
  预期总值（可能为 None）
</ResponseField>

<ResponseField name="message" type="str | None">
  可选的状态消息（可能为 None）
</ResponseField>
</Card>


## 每次调用的进度处理程序

为特定工具调用覆盖进度处理程序：

```python
async with client:
    # 为此调用使用特定的进度处理程序覆盖
    result = await client.call_tool(
        "long_running_task", 
        {"param": "value"}, 
        progress_handler=my_progress_handler
    )
```
