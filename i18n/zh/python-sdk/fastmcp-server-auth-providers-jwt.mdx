---
title: jwt
sidebarTitle: jwt
---

# `fastmcp.server.auth.providers.jwt`


FastMCP 的 TokenVerifier 实现。

## 类

### `JWKData` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L27" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


JSON Web Key 数据结构。


### `JWKSData` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L40" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


JSON Web Key Set 数据结构。


### `RSAKeyPair` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L47" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


用于 JWT 测试的 RSA 密钥对。


**方法：**

#### `generate` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L54" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
generate(cls) -> RSAKeyPair
```

生成用于测试的 RSA 密钥对。

**返回值：**
- 生成的密钥对


#### `create_token` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L89" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
create_token(self, subject: str = 'fastmcp-user', issuer: str = 'https://fastmcp.example.com', audience: str | list[str] | None = None, scopes: list[str] | None = None, expires_in_seconds: int = 3600, additional_claims: dict[str, Any] | None = None, kid: str | None = None) -> str
```

生成用于测试目的的测试 JWT 令牌。

**参数：**
- `subject`: 主体声明（通常为用户 ID）
- `issuer`: 发行者声明
- `audience`: 受众声明 - 可以是字符串或字符串列表（可选）
- `scopes`: 要包含的范围列表
- `expires_in_seconds`: 令牌过期时间（秒）
- `additional_claims`: 要包含的任何额外声明
- `kid`: 要在头部中包含的密钥 ID


### `JWTVerifierSettings` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L142" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


JWT 令牌验证设置。


### `JWTVerifier` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L165" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


支持非对称（RSA/ECDSA）和对称（HMAC）算法的 JWT 令牌验证器。

此验证器使用各种签名算法验证 JWT 令牌：
- **非对称算法**（RS256/384/512、ES256/384/512、PS256/384/512）：
  使用公钥/私钥对。适用于外部客户端和服务，在这种情况下
  只有授权服务器拥有私钥。
- **对称算法**（HS256/384/512）：使用共享密钥进行
  签名和验证。非常适合内部微服务和可信
  环境，在这些环境中可以安全地共享密钥。

在以下情况下使用：
- 您有由外部服务颁发的 JWT 令牌（非对称）
- 您需要 JWKS 支持以实现自动密钥轮换（非对称）
- 您有共享密钥的内部微服务（对称）
- 您的令牌包含标准 OAuth 作用域和声明


**方法：**

#### `load_access_token` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L367" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
load_access_token(self, token: str) -> AccessToken | None
```

验证提供的 JWT 承载令牌。

**参数：**
- `token`: 要验证的 JWT 令牌字符串

**返回值：**
- 如果有效则返回 AccessToken 对象，如果无效或过期则返回 None


#### `verify_token` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L474" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
verify_token(self, token: str) -> AccessToken | None
```

验证承载令牌并在有效时返回访问信息。

此方法通过委托给我们现有的 load_access_token 方法
来实现 TokenVerifier 协议。

**参数：**
- `token`: 要验证的 JWT 令牌字符串

**返回值：**
- 如果有效则返回 AccessToken 对象，如果无效或过期则返回 None


### `StaticTokenVerifier` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L490" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


用于测试和开发的简单静态令牌验证器。

此验证器根据预定义的有效令牌字符串及其相关声明的字典
来验证令牌。当令牌字符串与字典中的键匹配时，
验证器返回相应的声明，就像令牌由真正的授权服务器验证一样。


在以下情况下使用：
- 您在未使用真正 OAuth 服务器的情况下进行本地开发或测试
- 您需要可预测的令牌进行自动化测试
- 您想要在不复杂设置的情况下模拟不同的用户/范围
- 您正在进行原型制作，需要简单的 API 密钥风格认证

警告：绝不要在生产环境中使用 - 令牌以明文形式存储！


**方法：**

#### `verify_token` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L524" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
verify_token(self, token: str) -> AccessToken | None
```

根据静态令牌字典验证令牌。

