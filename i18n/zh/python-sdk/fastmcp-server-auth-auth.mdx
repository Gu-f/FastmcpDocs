---
title: auth
sidebarTitle: auth
---

# `fastmcp.server.auth.auth`

## 类

### `AccessToken` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L32" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


包含所有 JWT 声明的访问令牌。


### `AuthProvider` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L38" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


所有 FastMCP 认证提供者的基类。

此类为所有认证提供者提供统一接口，
无论它们是简单的令牌验证器还是完整的 OAuth 授权服务器。
所有提供者都必须能够验证令牌，并可选择性地提供
自定义认证路由。


**方法：**

#### `verify_token` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L65" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
verify_token(self, token: str) -> AccessToken | None
```

验证承载令牌并在有效时返回访问信息。

所有认证提供者都必须实现令牌验证。

**参数：**
- `token`: 要验证的令牌字符串

**返回值：**
- 如果有效则返回 AccessToken 对象，如果无效或过期则返回 None


#### `get_routes` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L78" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
get_routes(self, mcp_path: str | None = None) -> list[Route]
```

获取此认证提供者的所有路由。

这包括众所周知的发现路由和操作路由。
每个提供者负责创建其所需的路由：
- TokenVerifier：通常没有路由（默认实现）
- RemoteAuthProvider：受保护资源元数据路由
- OAuthProvider：完整的 OAuth 授权服务器路由
- 自定义提供者：其所需的任何路由

**参数：**
- `mcp_path`: MCP 端点挂载的路径（例如，"/mcp"）
这用于在元数据中公布资源 URL，但
提供者不会创建实际的 MCP 端点路由。

**返回值：**
- 此提供者的所有路由列表（不包括 MCP 端点本身）


#### `get_well_known_routes` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L101" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
get_well_known_routes(self, mcp_path: str | None = None) -> list[Route]
```

获取此认证提供者的众所周知的发现路由。

这是一个实用方法，用于过滤 get_routes() 以仅返回
众所周知的发现路由（以 /.well-known/ 开头的路由）。

众所周知的路由提供 OAuth 元数据和发现端点，
客户端使用它们来发现认证能力。这些路由应该
挂载在应用程序的根级别以符合 RFC 8414
和 RFC 9728。

常见的众所周知的路由：
- /.well-known/oauth-authorization-server (授权服务器元数据)
- /.well-known/oauth-protected-resource/* (受保护资源元数据)

**参数：**
- `mcp_path`: MCP 端点挂载的路径（例如，"/mcp"）
这用于构造路径范围的众所周知的 URL。

**返回值：**
- 众所周知的发现路由列表（通常挂载在根级别）


#### `get_middleware` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L133" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
get_middleware(self) -> list
```

获取此认证提供者的 HTTP 应用程序级中间件。

**返回值：**
- 要应用到 HTTP 应用程序的 Starlette 中间件实例列表


### `TokenVerifier` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L166" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


令牌验证器（资源服务器）的基类。

此类提供令牌验证功能，但不具备 OAuth 服务器功能。
令牌验证器通常默认情况下不提供认证路由。


**方法：**

#### `verify_token` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L187" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
verify_token(self, token: str) -> AccessToken | None
```

验证承载令牌并在有效时返回访问信息。


### `RemoteAuthProvider` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L192" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


用于资源服务器的认证提供者，验证来自已知授权服务器的令牌。

此提供者将 TokenVerifier 与授权服务器元数据组合以创建
标准化的 OAuth 2.0 受保护资源端点（RFC 9728）。适用于：
- 与已知发行者的 JWT 验证
- 远程令牌内省服务
- 任何知道其令牌来源的资源服务器

当您有令牌验证逻辑并想要宣传
颁发有效令牌的授权服务器时使用此选项。


**方法：**

#### `verify_token` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L233" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
verify_token(self, token: str) -> AccessToken | None
```

使用配置的令牌验证器验证令牌。


#### `get_routes` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L237" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
get_routes(self, mcp_path: str | None = None) -> list[Route]
```

获取此提供者的路由。

创建受保护资源元数据路由（RFC 9728）。


### `OAuthProvider` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L265" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


OAuth 授权服务器提供者。

此类提供完整的 OAuth 服务器功能，包括客户端注册、
授权流程、令牌颁发和令牌验证。


**方法：**

#### `verify_token` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L321" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
verify_token(self, token: str) -> AccessToken | None
```

验证承载令牌并在有效时返回访问信息。

此方法通过委托给我们现有的 load_access_token 方法
来实现 TokenVerifier 协议。

**参数：**
- `token`: 要验证的令牌字符串

**返回值：**
- 如果有效则返回 AccessToken 对象，如果无效或过期则返回 None


#### `get_routes` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L336" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
get_routes(self, mcp_path: str | None = None) -> list[Route]
```

获取 OAuth 授权服务器路由和可选的受保护资源路由。

此方法创建完整的 OAuth 路由集，包括：
- 标准 OAuth 授权服务器路由（/.well-known/oauth-authorization-server、/authorize、/token 等）
- 可选的受保护资源路由

**返回值：**
- OAuth 路由列表

