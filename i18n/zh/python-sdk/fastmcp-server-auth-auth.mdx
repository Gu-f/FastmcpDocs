---
title: auth
sidebarTitle: auth
---

# `fastmcp.server.auth.auth`

## 类

### `AccessToken` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L36" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


包含所有 JWT 声明的访问令牌。


### `AuthProvider` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L42" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


所有 FastMCP 认证提供者的基类。

此类为所有认证提供者提供统一接口，
无论它们是简单的令牌验证器还是完整的 OAuth 授权服务器。
所有提供者都必须能够验证令牌，并可选择性地提供
自定义认证路由。


**方法：**

#### `verify_token` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L69" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
verify_token(self, token: str) -> AccessToken | None
```

验证承载令牌并在有效时返回访问信息。

所有认证提供者都必须实现令牌验证。

**参数：**
- `token`: 要验证的令牌字符串

**返回值：**
- 如果有效则返回 AccessToken 对象，如果无效或过期则返回 None


#### `get_routes` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L82" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
get_routes(self, mcp_path: str | None = None, mcp_endpoint: Any | None = None) -> list[Route]
```

获取此认证提供者的路由。

每个提供者负责创建其所需的路由：
- TokenVerifier：通常没有路由（默认实现）
- RemoteAuthProvider：受保护资源元数据路由
- OAuthProvider：完整的 OAuth 授权服务器路由
- 自定义提供者：其所需的任何路由

**Args:**
- `mcp_path`: The path where the MCP endpoint is mounted (e.g., "/mcp")
- `mcp_endpoint`: The MCP endpoint handler to protect with auth

**返回值：**
- List of routes for this provider, including protected MCP endpoints if provided


#### `get_middleware` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L122" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
get_middleware(self) -> list
```

Get HTTP application-level middleware for this auth provider.

**Returns:**
- List of Starlette Middleware instances to apply to the HTTP app


### `TokenVerifier` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L154" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


令牌验证器（资源服务器）的基类。

此类提供令牌验证功能，但不具备 OAuth 服务器功能。
令牌验证器通常默认情况下不提供认证路由。


**方法：**

#### `verify_token` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L175" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
verify_token(self, token: str) -> AccessToken | None
```

Verify a bearer token and return access info if valid.


### `RemoteAuthProvider` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L180" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


用于资源服务器的认证提供者，验证来自已知授权服务器的令牌。

此提供者将 TokenVerifier 与授权服务器元数据组合以创建
标准化的 OAuth 2.0 受保护资源端点（RFC 9728）。适用于：
- 与已知发行者的 JWT 验证
- 远程令牌内省服务
- 任何知道其令牌来源的资源服务器

当您有令牌验证逻辑并想要宣传
颁发有效令牌的授权服务器时使用此选项。


**方法：**

#### `verify_token` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L221" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
verify_token(self, token: str) -> AccessToken | None
```

使用配置的令牌验证器验证令牌。


#### `get_routes` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L225" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
get_routes(self, mcp_path: str | None = None, mcp_endpoint: Any | None = None) -> list[Route]
```

获取此提供者的 OAuth 路由。

Creates protected resource metadata routes and optionally wraps MCP endpoints with auth.


### `OAuthProvider` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L255" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


OAuth 授权服务器提供者。

此类提供完整的 OAuth 服务器功能，包括客户端注册、
授权流程、令牌颁发和令牌验证。


**方法：**

#### `verify_token` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L311" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
verify_token(self, token: str) -> AccessToken | None
```

验证承载令牌并在有效时返回访问信息。

此方法通过委托给我们现有的 load_access_token 方法
来实现 TokenVerifier 协议。

**参数：**
- `token`: 要验证的令牌字符串

**返回值：**
- 如果有效则返回 AccessToken 对象，如果无效或过期则返回 None


#### `get_routes` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/auth.py#L326" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
get_routes(self, mcp_path: str | None = None, mcp_endpoint: Any | None = None) -> list[Route]
```

获取 OAuth 授权服务器路由和可选的受保护资源路由。

此方法创建完整的 OAuth 路由集，包括：
- 标准 OAuth 授权服务器路由（/.well-known/oauth-authorization-server、/authorize、/token 等）
- Optional protected resource routes
- Protected MCP endpoints if provided

**返回值：**
- OAuth 路由列表

