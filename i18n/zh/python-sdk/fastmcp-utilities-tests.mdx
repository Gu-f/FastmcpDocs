---
title: tests
sidebarTitle: tests
---

# `fastmcp.utilities.tests`

## 函数

### `temporary_settings` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/tests.py#L25" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
temporary_settings(**kwargs: Any)
```


临时覆盖 FastMCP 设置值。

**参数：**
- `**kwargs`: 要覆盖的设置，包括嵌套设置。


### `run_server_in_process` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/tests.py#L75" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
run_server_in_process(server_fn: Callable[..., None], *args, **kwargs) -> Generator[str, None, None]
```


在单独的进程中运行 FastMCP 服务器并返回服务器 URL 的上下文管理器。当上下文管理器退出时，服务器进程将被终止。

**参数：**
- `server_fn`: 运行 FastMCP 服务器的函数。FastMCP 服务器不可 pickle 化，因此我们需要一个创建并运行服务器的函数。
- `*args`: 传递给服务器函数的参数。
- `provide_host_and_port`: 是否将主机和端口作为关键字参数提供给服务器函数。
- `host`: 要绑定的服务器地址 (默认\: "127.0.0.1").
- `port`: 要绑定的服务器端口 (默认\: 自动发现有效端口).
- `**kwargs`: 传递给服务器函数的关键字参数。

**返回值：**
- 服务器 URL。


### `caplog_for_fastmcp` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/tests.py#L141" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
caplog_for_fastmcp(caplog)
```


即使在禁用传播时也能捕获来自 FastMCP 记录器的日志的上下文管理器。


## 类

### `HeadlessOAuth` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/tests.py#L152" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


用于绕过浏览器交互进行测试的 OAuth 提供程序。

通过发起 HTTP 请求而不是打开浏览器和运行回调服务器来程序化地模拟完整的 OAuth 流程。对自动化测试很有用。


**方法：**

#### `redirect_handler` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/tests.py#L165" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
redirect_handler(self, authorization_url: str) -> None
```

向授权 URL 发出 HTTP 请求并为回调处理程序存储响应。


#### `callback_handler` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/tests.py#L171" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
callback_handler(self) -> tuple[str, str | None]
```

解析存储的响应并返回 (auth_code, state)。

