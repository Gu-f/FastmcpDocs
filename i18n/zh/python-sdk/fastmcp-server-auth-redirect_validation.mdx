---
title: redirect_validation
sidebarTitle: redirect_validation
---

# `fastmcp.server.auth.redirect_validation`


用于在 OAuth 流程中验证客户端重定向 URI 的实用工具。

## 函数

### `matches_allowed_pattern` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/redirect_validation.py#L8" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
matches_allowed_pattern(uri: str, pattern: str) -> bool
```


检查 URI 是否与支持通配符的允许模式匹配。

模式支持 * 通配符匹配：
- http://localhost:* 匹配任意 localhost 端口
- http://127.0.0.1:* 匹配任意 127.0.0.1 端口
- https://*.example.com/* 匹配 example.com 的任意子域名
- https://app.example.com/auth/* 匹配 /auth/ 下的任意路径

**参数：**
- `uri`: 要验证的重定向 URI
- `pattern`: 允许的模式（可能包含通配符）

**返回值：**
- 如果 URI 与模式匹配则返回 True


### `validate_redirect_uri` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/redirect_validation.py#L28" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
validate_redirect_uri(redirect_uri: str | AnyUrl | None, allowed_patterns: list[str] | None) -> bool
```


根据允许的模式验证重定向 URI。

**参数：**
- `redirect_uri`: 要验证的重定向 URI
- `allowed_patterns`: 允许的模式列表。如果为 None，则允许所有 URI（为 DCR 兼容性）。
             如果为空列表，则不允许任何 URI。
             要仅限制为 localhost，请明确传递 DEFAULT_LOCALHOST_PATTERNS。

**返回值：**
- 如果允许重定向 URI 则返回 True

