---
title: mcp_server_config
sidebarTitle: mcp_server_config
---

# `fastmcp.utilities.mcp_server_config.v1.mcp_server_config`


FastMCP 配置文件支持。

此模块为 fastmcp.json 配置文件提供支持，允许
用户以声明式格式指定服务器设置，而不使用
命令行参数。


## 函数

### `generate_schema` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L416" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
generate_schema(output_path: Path | str | None = None) -> dict[str, Any] | None
```


为 fastmcp.json 文件生成 JSON 模式。

这用于创建 IDE 可用于
验证和自动补全的模式文件。

**参数：**
- `output_path`: 写入模式的可选路径。如果提供，
        则写入模式并返回 None。如果未提供，
        则将模式作为字典返回。

**返回值：**
- 如果 output_path 为 None，则返回字典形式的 JSON 模式，否则返回 None


## 类

### `Deployment` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L36" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


服务器部署和运行时设置的配置。


**方法：**

#### `apply_runtime_settings` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L85" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
apply_runtime_settings(self, config_path: Path | None = None) -> None
```

应用运行时设置，如环境变量和工作目录。

**参数：**
- `config_path`: 用于解析相对路径的配置文件路径

环境变量支持使用 ${VAR_NAME} 语法进行插值。
例如："API_URL": "https://api.${ENVIRONMENT}.example.com"
将在运行时替换 ENVIRONMENT 变量的值。


### `MCPServerConfig` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L134" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>


FastMCP 服务器的配置。

此配置文件允许您以声明式格式指定运行
FastMCP 服务器所需的所有设置。


**方法：**

#### `validate_source` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L183" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
validate_source(cls, v: dict | Source) -> SourceType
```

验证并将源转换为正确的格式。

支持：
- 字典格式：`{"path": "server.py", "entrypoint": "app"}`
- FileSystemSource 实例（直接传递）

这里不会发生字符串解析 - 这只在 CLI 边界发生。
MCPServerConfig 只使用正确类型的对象。


#### `validate_environment` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L199" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
validate_environment(cls, v: dict | Any) -> EnvironmentType
```

确保环境具有用于区分的类型字段。

为了向后兼容，如果未指定类型，则默认为 "uv"。


#### `validate_deployment` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L210" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
validate_deployment(cls, v: dict | Deployment) -> Deployment
```

验证并将部署转换为 Deployment。

接受：
- Deployment 实例
- 可转换为 Deployment 的字典


#### `from_file` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L223" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
from_file(cls, file_path: Path) -> MCPServerConfig
```

从 JSON 文件加载配置。

**参数：**
- `file_path`: 配置文件的路径

**返回值：**
- MCPServerConfig 实例

**引发异常：**
- `FileNotFoundError`: 如果文件不存在
- `json.JSONDecodeError`: 如果文件不是有效的 JSON
- `pydantic.ValidationError`: 如果配置无效


#### `from_cli_args` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L246" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
from_cli_args(cls, source: FileSystemSource, transport: Literal['stdio', 'http', 'sse', 'streamable-http'] | None = None, host: str | None = None, port: int | None = None, path: str | None = None, log_level: Literal['DEBUG', 'INFO', 'WARNING', 'ERROR', 'CRITICAL'] | None = None, python: str | None = None, dependencies: list[str] | None = None, requirements: str | None = None, project: str | None = None, editable: str | None = None, env: dict[str, str] | None = None, cwd: str | None = None, args: list[str] | None = None) -> MCPServerConfig
```

从 CLI 参数创建配置。

这允许我们有一个单一的代码路径，其中所有内容
都通过配置对象。

**参数：**
- `source`: 服务器源（FileSystemSource 实例）
- `transport`: 传输协议
- `host`: HTTP 传输的主机
- `port`: HTTP 传输的端口
- `path`: 服务器的 URL 路径
- `log_level`: 日志级别
- `python`: Python 版本
- `dependencies`: 要安装的 Python 包
- `requirements`: requirements 文件的路径
- `project`: 项目目录的路径
- `editable`: 以可编辑模式安装的路径
- `env`: 环境变量
- `cwd`: 工作目录
- `args`: 服务器参数

**返回值：**
- MCPServerConfig 实例


#### `find_config` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L323" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
find_config(cls, start_path: Path | None = None) -> Path | None
```

在指定目录中查找 fastmcp.json 文件。

**参数：**
- `start_path`: 要查找的目录（默认为当前目录）

**返回值：**
- 配置文件的路径，如果未找到则为 None


#### `prepare` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L342" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
prepare(self, skip_source: bool = False, output_dir: Path | None = None) -> None
```

为执行准备环境和源。

当提供 output_dir 时，创建一个持久化的 uv 项目。
当 output_dir 为 None 时，执行临时缓存（为了向后兼容）。

**参数：**
- `skip_source`: 如果为 True，则跳过源准备
- `output_dir`: 在其中创建持久化 uv 项目的目录（可选）


#### `prepare_environment` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L363" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
prepare_environment(self, output_dir: Path | None = None) -> None
```

准备 Python 环境。

**参数：**
- `output_dir`: 如果提供，在此目录中创建持久化的 uv 项目。
       如果为 None，则只填充 uv 的缓存以供临时使用。

委托给环境的 prepare() 方法


#### `prepare_source` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L374" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
prepare_source(self) -> None
```

为加载准备源。

委托给源的 prepare() 方法。


#### `run_server` <sup><a href="https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/utilities/mcp_server_config/v1/mcp_server_config.py#L381" target="_blank"><Icon icon="github" style="width: 14px; height: 14px;" /></a></sup>

```python
run_server(self, **kwargs: Any) -> None
```

使用此配置加载并运行服务器。

**参数：**
- `**kwargs`: 传递给 server.run_async() 的附加参数
     这些参数会覆盖配置设置

