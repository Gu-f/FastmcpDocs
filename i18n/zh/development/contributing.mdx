---
title: "贡献指南"
description: "FastMCP 贡献者的开发工作流程"
icon: code-pull-request
---

为 FastMCP 做贡献意味着加入一个重视简洁、可维护代码和深思熟虑的 API 设计的社区。所有贡献都是有价值的 - 从修复文档中的拼写错误到实现主要功能。

## 问题（Issues）

### 先提问题，后写代码

**每个拉取请求都需要对应的问题 - 没有例外。** 这一要求创建了一个协作空间，在编写代码之前确定方法、范围和一致性。问题作为设计文档，维护者和贡献者在其中讨论实施策略，识别与现有模式的潜在冲突，并确保提议的更改推进 FastMCP 的愿景。

**FastMCP 是一个有主见的框架，而不是大杂烩。** 维护者对 FastMCP 应该做什么和不应该做什么有强烈的信念。仅仅因为某些功能需要 N 行代码而您希望用更少的行数实现，并不意味着 FastMCP 应该承担维护负担或认可该模式。这由维护者自行判断。

在打开 PR 之前使用问题来了解范围。问题讨论决定了一个功能属于核心、贡献模块，还是根本不属于。

### 编写好的问题

FastMCP 是一个流量极高的仓库，由一个非常小的团队维护。那些看起来将负担转移给维护者而没有任何验证问题努力的问题将被关闭。请通过始终提供最小可重现示例和清楚地描述问题来帮助维护者帮助您。

**LLM 生成的问题将立即关闭。** 包含不必要解释段落、冗长问题描述或明显 LLM 创作模式的问题会混淆实际问题并将负担转移给维护者。

编写清晰、简洁的问题：
- 直接陈述问题
- 提供最小可重现示例
- 跳过不必要的背景或上下文
- 为清晰沟通负责

问题可能仅仅因为冗长造成的混乱或不遵守此处概述的指导原则而被标记为"Invalid"。

## 拉取请求（Pull Requests）

偏离 FastMCP 核心原则的 PR 将被拒绝，无论实现质量如何。**PR 不是用来迭代想法的** - 它们应该只为基于问题讨论已经倾向于被接受的想法而打开。


### 开发环境

#### 安装

要为 FastMCP 做贡献，您需要设置一个包含所有必要工具和依赖项的开发环境。

```bash
# 克隆仓库
git clone https://github.com/jlowin/fastmcp.git
cd fastmcp

# 安装所有依赖项，包括开发工具
uv sync

# 安装预提交钩子
uv run pre-commit install
```

此外，一些开发命令需要安装 [just](https://github.com/casey/just)。

预提交钩子将在每次提交时自动运行，以在问题到达 CI 之前捕获问题。如果您看到失败，请在提交前修复它们 - 永远不要提交损坏的代码期望稍后修复。

### 开发标准

#### 范围

大型拉取请求会产生审查瓶颈和质量风险。除非您正在修复一个独立的错误或进行一个范围极其明确的更改，否则请保持 PR 小而专注。

一个跨 3 个文件更改 50 行的 PR 可以在几分钟内得到彻底审查。一个跨 20 个文件更改 500 行的 PR 需要数小时的仔细分析，并且经常隐藏微妙的问题。

将大型功能分解为较小的 PR：
- 创造更好的审查体验
- 使 git 历史清晰
- 简化使用 bisect 进行调试
- 减少合并冲突
- 让您的代码更快合并

#### 代码质量

FastMCP 重视清晰性胜过巧妙性。您编写的每一行代码都将由其他人维护 - 可能是几年后，可能没有关于您决策的上下文。

**PR 可能因为两个相反的原因被拒绝：**
1. **质量不足** - 不符合我们的清晰性、可维护性或惯用性标准的代码
2. **过度工程化** - 过于复杂、不必要复杂或试图过于巧妙的代码

重点是惯用的、高质量的 Python。FastMCP 使用诸如 `NotSet` 类型作为在某些情况下 `None` 的替代等模式 - 遵循现有模式。

#### 必需实践

所有函数和方法的**完整类型注解**。它们在运行时之前捕获错误，并作为内联文档。

所有 I/O 操作的 **Async/await 模式**。即使您的特定用例不需要并发，一致性意味着用户可以组合功能而不必担心阻塞操作。

**描述性名称**使代码自文档化。`auth_token` 是清晰的；`tok` 需要心理翻译。

**特定异常类型**使错误处理可预测。捕获 `ValueError` 告诉读者您期望的确切错误。永远不要使用裸露的 `except` 子句。

#### 要避免的反模式

**复杂的单行代码**难以调试和修改。将操作分解为清晰的步骤。

**可变默认参数**会导致微妙的错误。使用 `None` 作为默认值，并在函数内部创建可变对象。

**破坏既定模式**会混淆读者。如果您必须偏离，请先在问题中讨论。

### 预提交检查

```bash
# 在提交时自动运行，或手动运行：
uv run pre-commit run --all-files
```

这将运行三个关键工具：
- **Ruff**：代码检查和格式化
- **ty**：静态类型检查  
- **Pytest**：核心测试套件

CI 将拒绝未通过这些检查的 PR。始终先在本地运行它们。

### 测试

测试是展示功能如何工作的文档。好的测试给审查者信心，并帮助未来的维护者理解意图。

```bash
# 运行特定测试目录
uv run pytest tests/server/ -v

# 在提交 PR 之前运行所有测试
uv run pytest
```

每个新功能都需要测试。请参阅[测试指南](/zh/development/tests)了解模式和要求。

### 文档

除非有文档记录，否则功能不存在。请注意，FastMCP 的托管文档始终跟踪主分支 - 想要历史文档的用户可以克隆仓库，检出特定标签，并自己托管。

```bash
# 在本地预览文档
just docs
```

文档要求：
- **首先用散文解释概念** - 没有上下文的代码只是语法
- **完整、可运行的示例** - 每个代码块都应该可以复制粘贴
- **在 docs.json 中注册** - 使页面出现在导航中
- **版本徽章** - 使用 `<VersionBadge />` 标记功能添加时间

#### SDK 文档

FastMCP 的 SDK 文档是从源代码文档字符串和类型注解自动生成的。它通过 GitHub Actions 工作流在每次合并到主分支时自动更新，因此用户*无需*负责保持文档最新。但是，要主动生成它，您可以使用以下命令：

```bash
just api-ref-all
```

### 提交您的 PR

#### 提交前

1. **运行所有检查**：`uv run pre-commit run --all-files && uv run pytest`
2. **保持范围小**：每个 PR 一个功能或修复
3. **编写清晰描述**：您的 PR 描述成为永久文档
4. **更新文档**：包含 API 更改的文档

#### PR 描述

编写解释以下内容的 PR 描述：
- 您正在解决什么问题
- 为什么选择这种方法  
- 考虑的任何权衡或替代方案
- 破坏性更改的迁移路径

专注于"为什么" - 代码显示"什么"。保持简洁但完整。

#### 我们寻找什么

**框架理念**：FastMCP 不试图做所有事情或提供所有快捷方式。当功能与框架愿景不一致时，即使实现完美也会被拒绝。PR 有责任证明其价值。

**代码质量**：我们验证代码遵循现有模式。一致性减少认知负担。当每个模块都以相似方式工作时，开发者可以快速理解新代码。

**测试覆盖**：不是每一行都需要测试，但每个行为都需要。测试记录意图并防止回归。

**破坏性更改**：在次要版本中可能是可接受的，但必须清楚地记录。请参阅[版本控制策略](/zh/development/releases#versioning-policy)。

## 特殊模块

**`社区贡献`**：社区维护的模式和工具。原作者维护他们的贡献。不代表核心框架。

**`实验性功能`**：维护者开发的功能，可能预览未来功能。可能随时中断或删除，恕不另行通知。使用这些功能时请固定您的 FastMCP 版本。