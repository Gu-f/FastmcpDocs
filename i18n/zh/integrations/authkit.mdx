---
title: AuthKit ğŸ¤ FastMCP
sidebarTitle: AuthKit
description: ä½¿ç”¨ WorkOS çš„ AuthKit ä¿æŠ¤æ‚¨çš„ FastMCP æœåŠ¡å™¨
icon: shield-check
tag: NEW
---

import { VersionBadge } from "/snippets/version-badge.mdx"

<VersionBadge version="2.11.0" />

æœ¬æŒ‡å—å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨ WorkOS çš„ **AuthKit**ï¼ˆä¸€ä¸ªå®Œæ•´çš„èº«ä»½éªŒè¯å’Œç”¨æˆ·ç®¡ç†è§£å†³æ–¹æ¡ˆï¼‰æ¥ä¿æŠ¤æ‚¨çš„ FastMCP æœåŠ¡å™¨ã€‚æ­¤é›†æˆä½¿ç”¨[**è¿œç¨‹ OAuth**](/zh/servers/auth/remote-oauth) æ¨¡å¼ï¼Œå…¶ä¸­ AuthKit å¤„ç†ç”¨æˆ·ç™»å½•ï¼Œæ‚¨çš„ FastMCP æœåŠ¡å™¨éªŒè¯ä»¤ç‰Œã€‚


## é…ç½®
### å…ˆå†³æ¡ä»¶

åœ¨å¼€å§‹ä¹‹å‰ï¼Œæ‚¨éœ€è¦ï¼š
1.  ä¸€ä¸ª **[WorkOS è´¦æˆ·](https://workos.com/)** å’Œä¸€ä¸ªæ–°çš„**é¡¹ç›®**ã€‚
2.  åœ¨æ‚¨çš„ WorkOS é¡¹ç›®ä¸­é…ç½®çš„ **[AuthKit](https://www.authkit.com/)** å®ä¾‹ã€‚
3.  æ‚¨çš„ FastMCP æœåŠ¡å™¨çš„ URLï¼ˆå¼€å‘æ—¶å¯ä»¥æ˜¯ localhostï¼Œä¾‹å¦‚ `http://localhost:8000`ï¼‰ã€‚

### æ­¥éª¤ 1ï¼šAuthKit é…ç½®

åœ¨æ‚¨çš„ WorkOS ä»ªè¡¨æ¿ä¸­ï¼Œå¯ç”¨ AuthKit å¹¶é…ç½®ä»¥ä¸‹è®¾ç½®ï¼š

<Steps>
<Step title="å¯ç”¨åŠ¨æ€å®¢æˆ·ç«¯æ³¨å†Œ">
    è½¬åˆ° **Applications â†’ Configuration** å¹¶å¯ç”¨ **Dynamic Client Registration**ã€‚è¿™å…è®¸ MCP å®¢æˆ·ç«¯è‡ªåŠ¨æ³¨å†Œåˆ°æ‚¨çš„åº”ç”¨ç¨‹åºã€‚

    ![Enable Dynamic Client Registration](./images/authkit/enable_dcr.png)
</Step>

<Step title="è®°å½•æ‚¨çš„ AuthKit åŸŸå">
    åœ¨é…ç½®é¡µé¢ä¸Šæ‰¾åˆ°æ‚¨çš„ **AuthKit Domain**ã€‚å®ƒçœ‹èµ·æ¥åƒ `https://your-project-12345.authkit.app`ã€‚æ‚¨åœ¨ FastMCP æœåŠ¡å™¨é…ç½®ä¸­éœ€è¦è¿™ä¸ªåŸŸåã€‚
</Step>
</Steps>

### æ­¥éª¤ 2ï¼šFastMCP é…ç½®

åˆ›å»ºæ‚¨çš„ FastMCP æœåŠ¡å™¨æ–‡ä»¶å¹¶ä½¿ç”¨ `AuthKitProvider` è‡ªåŠ¨å¤„ç†æ‰€æœ‰ OAuth é›†æˆï¼š

```python server.py
from fastmcp import FastMCP
from fastmcp.server.auth.providers.workos import AuthKitProvider

# AuthKitProvider ä¼šè‡ªåŠ¨å‘ç° WorkOS ç«¯ç‚¹
# å¹¶é…ç½® JWT ä»¤ç‰ŒéªŒè¯
auth_provider = AuthKitProvider(
    authkit_domain="https://your-project-12345.authkit.app",
    base_url="http://localhost:8000"  # ä½¿ç”¨æ‚¨çš„å®é™…æœåŠ¡å™¨URL
)

mcp = FastMCP(name="AuthKit å®‰å…¨åº”ç”¨ç¨‹åº", auth=auth_provider)
```

## æµ‹è¯•

è¦æµ‹è¯•æ‚¨çš„æœåŠ¡å™¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `fastmcp` CLI åœ¨æœ¬åœ°è¿è¡Œå®ƒã€‚å‡è®¾æ‚¨å·²å°†ä¸Šè¿°ä»£ç ä¿å­˜åˆ° `server.py`ï¼ˆåœ¨å°† `authkit_domain` å’Œ `base_url` æ›¿æ¢ä¸ºæ‚¨çš„å®é™…å€¼ä¹‹åï¼ï¼‰ï¼Œæ‚¨å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
fastmcp run server.py --transport http --port 8000
```

ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ FastMCP å®¢æˆ·ç«¯æµ‹è¯•åœ¨èº«ä»½éªŒè¯åæ˜¯å¦å¯ä»¥è®¿é—®æ‚¨çš„æœåŠ¡å™¨ï¼š

```python
from fastmcp import Client
import asyncio

async def main():
    async with Client("http://localhost:8000/mcp/", auth="oauth") as client:
        assert await client.ping()

if __name__ == "__main__":
    asyncio.run(main())
```


## ç¯å¢ƒå˜é‡

<VersionBadge version="2.12.1" />

å¯¹äºç”Ÿäº§éƒ¨ç½²ï¼Œè¯·ä½¿ç”¨ç¯å¢ƒå˜é‡è€Œä¸æ˜¯ç¡¬ç¼–ç å‡­æ®ã€‚

### æä¾›ç¨‹åºé€‰æ‹©

è®¾ç½®æ­¤ç¯å¢ƒå˜é‡å…è®¸è‡ªåŠ¨ä½¿ç”¨ AuthKit æä¾›ç¨‹åºï¼Œè€Œæ— éœ€åœ¨ä»£ç ä¸­æ˜¾å¼å®ä¾‹åŒ–å®ƒã€‚

<Card>
<ParamField path="FASTMCP_SERVER_AUTH" default="æœªè®¾ç½®">
è®¾ç½®ä¸º `fastmcp.server.auth.providers.workos.AuthKitProvider` ä»¥ä½¿ç”¨ AuthKit èº«ä»½éªŒè¯ã€‚
</ParamField>
</Card>

### AuthKit ç‰¹å®šé…ç½®

è¿™äº›ç¯å¢ƒå˜é‡ä¸º AuthKit æä¾›ç¨‹åºæä¾›é»˜è®¤å€¼ï¼Œæ— è®ºå®ƒæ˜¯æ‰‹åŠ¨å®ä¾‹åŒ–çš„è¿˜æ˜¯é€šè¿‡ `FASTMCP_SERVER_AUTH` é…ç½®çš„ã€‚

<Card>
<ParamField path="FASTMCP_SERVER_AUTH_AUTHKITPROVIDER_AUTHKIT_DOMAIN" required>
æ‚¨çš„ AuthKit åŸŸï¼ˆä¾‹å¦‚ï¼Œ`https://your-project-12345.authkit.app`ï¼‰
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_AUTHKITPROVIDER_BASE_URL" required>
æ‚¨çš„ FastMCP æœåŠ¡å™¨çš„å…¬å…± URLï¼ˆä¾‹å¦‚ï¼Œ`https://your-server.com` æˆ–å¼€å‘æ—¶çš„ `http://localhost:8000`ï¼‰
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_AUTHKITPROVIDER_REQUIRED_SCOPES" default="[]">
å¿…éœ€çš„ OAuth ä½œç”¨åŸŸçš„é€—å·ã€ç©ºæ ¼æˆ– JSON åˆ†éš”åˆ—è¡¨ï¼ˆä¾‹å¦‚ï¼Œ`openid profile email` æˆ– `["openid", "profile", "email"]`ï¼‰
</ParamField>
</Card>

ç¤ºä¾‹ `.env` æ–‡ä»¶ï¼š
```bash
# ä½¿ç”¨ AuthKit æä¾›ç¨‹åº
FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.workos.AuthKitProvider

# AuthKit é…ç½®
FASTMCP_SERVER_AUTH_AUTHKITPROVIDER_AUTHKIT_DOMAIN=https://your-project-12345.authkit.app
FASTMCP_SERVER_AUTH_AUTHKITPROVIDER_BASE_URL=https://your-server.com
FASTMCP_SERVER_AUTH_AUTHKITPROVIDER_REQUIRED_SCOPES=openid,profile,email
```

è®¾ç½®ç¯å¢ƒå˜é‡åï¼Œæ‚¨çš„æœåŠ¡å™¨ä»£ç ç®€åŒ–ä¸ºï¼š

```python server.py
from fastmcp import FastMCP

# èº«ä»½éªŒè¯ä»ç¯å¢ƒä¸­è‡ªåŠ¨é…ç½®
mcp = FastMCP(name="AuthKit å®‰å…¨åº”ç”¨")
```