---
title: WorkOS ğŸ¤ FastMCP
sidebarTitle: WorkOS
description: ä½¿ç”¨ WorkOS Connect å¯¹ FastMCP æœåŠ¡å™¨è¿›è¡Œèº«ä»½éªŒè¯
icon: shield-check
tag: NEW
---

import { VersionBadge } from "/snippets/version-badge.mdx"

<VersionBadge version="2.12.0" />

ä½¿ç”¨ WorkOS Connect èº«ä»½éªŒè¯ä¿æŠ¤æ‚¨çš„ FastMCP æœåŠ¡å™¨ã€‚æ­¤é›†æˆä½¿ç”¨ OAuth ä»£ç†æ¨¡å¼é€šè¿‡ WorkOS Connect å¤„ç†èº«ä»½éªŒè¯ï¼ŒåŒæ—¶ä¿æŒä¸ MCP å®¢æˆ·ç«¯çš„å…¼å®¹æ€§ã€‚

<Note>
æœ¬æŒ‡å—æ¶µç›– WorkOS Connect åº”ç”¨ç¨‹åºã€‚å¯¹äºä½¿ç”¨ AuthKit çš„åŠ¨æ€å®¢æˆ·ç«¯æ³¨å†Œ (DCR)ï¼Œè¯·å‚é˜… [AuthKit é›†æˆ](/zh/integrations/authkit)ã€‚
</Note>

## é…ç½®

### å…ˆå†³æ¡ä»¶

å¼€å§‹ä¹‹å‰ï¼Œæ‚¨éœ€è¦ï¼š
1. ä¸€ä¸ªæœ‰æƒåˆ›å»º OAuth åº”ç”¨çš„ **[WorkOS è´¦æˆ·](https://workos.com/)**
2. æ‚¨çš„ FastMCP æœåŠ¡å™¨ URLï¼ˆå¼€å‘æ—¶å¯ä»¥æ˜¯ localhostï¼Œä¾‹å¦‚ `http://localhost:8000`ï¼‰

### æ­¥éª¤ 1ï¼šåˆ›å»º WorkOS OAuth åº”ç”¨

åœ¨æ‚¨çš„ WorkOS ä»ªè¡¨æ¿ä¸­åˆ›å»º OAuth åº”ç”¨ä»¥è·å–èº«ä»½éªŒè¯æ‰€éœ€çš„å‡­æ®ï¼š

<Steps>
<Step title="åˆ›å»º OAuth åº”ç”¨ç¨‹åº">
åœ¨æ‚¨çš„ WorkOS ä»ªè¡¨æ¿ä¸­ï¼š
1. å¯¼èˆªåˆ° **Applications**
2. ç‚¹å‡» **Create Application** 
3. é€‰æ‹© **OAuth Application**
4. ä¸ºæ‚¨çš„åº”ç”¨ç¨‹åºå‘½å
</Step>

<Step title="è·å–å‡­æ®">
åœ¨æ‚¨çš„ OAuth åº”ç”¨ç¨‹åºè®¾ç½®ä¸­ï¼š
1. å¤åˆ¶æ‚¨çš„ **Client ID**ï¼ˆä»¥ `client_` å¼€å¤´ï¼‰
2. ç‚¹å‡» **Generate Client Secret** å¹¶å®‰å…¨ä¿å­˜
3. å¤åˆ¶æ‚¨çš„ **AuthKit Domain**ï¼ˆä¾‹å¦‚ï¼Œ`https://your-app.authkit.app`ï¼‰
</Step>

<Step title="é…ç½®é‡å®šå‘ URI">
åœ¨ **Redirect URIs** éƒ¨åˆ†ï¼š
- æ·»åŠ ï¼š`http://localhost:8000/auth/callback`ï¼ˆç”¨äºå¼€å‘ï¼‰
- å¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œæ·»åŠ æ‚¨æœåŠ¡å™¨çš„å…¬å…± URL + `/auth/callback`

<Warning>
å›è°ƒ URL å¿…é¡»å®Œå…¨åŒ¹é…ã€‚é»˜è®¤è·¯å¾„æ˜¯ `/auth/callback`ï¼Œä½†æ‚¨å¯ä»¥ä½¿ç”¨ `redirect_path` å‚æ•°è‡ªå®šä¹‰å®ƒã€‚
</Warning>
</Step>
</Steps>

### æ­¥éª¤ 2ï¼šFastMCP é…ç½®

ä½¿ç”¨ `WorkOSProvider` åˆ›å»ºæ‚¨çš„ FastMCP æœåŠ¡å™¨ï¼š

```python server.py
from fastmcp import FastMCP
from fastmcp.server.auth.providers.workos import WorkOSProvider

# é…ç½® WorkOS OAuth
auth = WorkOSProvider(
    client_id="client_YOUR_CLIENT_ID",
    client_secret="YOUR_CLIENT_SECRET",
    authkit_domain="https://your-app.authkit.app",
    base_url="http://localhost:8000",
    required_scopes=["openid", "profile", "email"]
)

mcp = FastMCP("WorkOS å—ä¿æŠ¤æœåŠ¡å™¨", auth=auth)

@mcp.tool
def protected_tool(message: str) -> str:
    """æ­¤å·¥å…·éœ€è¦èº«ä»½éªŒè¯ã€‚"""
    return f"å·²è®¤è¯ç”¨æˆ·è¯´ï¼š{message}"

if __name__ == "__main__":
    mcp.run(transport="http", port=8000)
```

## æµ‹è¯•

### è¿è¡ŒæœåŠ¡å™¨

ä½¿ç”¨ HTTP ä¼ è¾“å¯åŠ¨æ‚¨çš„ FastMCP æœåŠ¡å™¨ä»¥å¯ç”¨ OAuth æµç¨‹ï¼š

```bash
fastmcp run server.py --transport http --port 8000
```

æ‚¨çš„æœåŠ¡å™¨ç°åœ¨æ­£åœ¨è¿è¡Œå¹¶å—åˆ° WorkOS OAuth èº«ä»½éªŒè¯çš„ä¿æŠ¤ã€‚

### ä½¿ç”¨å®¢æˆ·ç«¯æµ‹è¯•

åˆ›å»ºä¸€ä¸ªæµ‹è¯•å®¢æˆ·ç«¯ï¼Œä¸æ‚¨çš„ WorkOS ä¿æŠ¤çš„æœåŠ¡å™¨è¿›è¡Œèº«ä»½éªŒè¯ï¼š

```python client.py
from fastmcp import Client
import asyncio

async def main():    
    # å®¢æˆ·ç«¯å°†è‡ªåŠ¨å¤„ç† WorkOS OAuth
    async with Client("http://localhost:8000/mcp", auth="oauth") as client:
        # é¦–æ¬¡è¿æ¥å°†åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­æ‰“å¼€ WorkOS ç™»å½•é¡µé¢
        print("âœ“ å·²é€šè¿‡ WorkOS èº«ä»½éªŒè¯ï¼")
        
        # æµ‹è¯•å—ä¿æŠ¤çš„å·¥å…·
        result = await client.call_tool("protected_tool", {"message": "Hello!"})
        print(result)

if __name__ == "__main__":
    asyncio.run(main())
```

å½“æ‚¨ç¬¬ä¸€æ¬¡è¿è¡Œå®¢æˆ·ç«¯æ—¶ï¼š
1. æ‚¨çš„æµè§ˆå™¨å°†æ‰“å¼€åˆ° WorkOS çš„æˆæƒé¡µé¢
2. åœ¨æ‚¨æˆæƒåº”ç”¨ç¨‹åºåï¼Œæ‚¨å°†è¢«é‡å®šå‘å›æ¥
3. å®¢æˆ·ç«¯æ¥æ”¶ä»¤ç‰Œå¹¶å¯ä»¥å‘å‡ºç»è¿‡èº«ä»½éªŒè¯çš„è¯·æ±‚

<Info>
å®¢æˆ·ç«¯åœ¨æœ¬åœ°ç¼“å­˜ä»¤ç‰Œï¼Œå› æ­¤é™¤éä»¤ç‰Œè¿‡æœŸæˆ–æ‚¨æ˜¾å¼æ¸…é™¤ç¼“å­˜ï¼Œå¦åˆ™æ‚¨æ— éœ€ä¸ºåç»­è¿è¡Œé‡æ–°è¿›è¡Œèº«ä»½éªŒè¯ã€‚
</Info>

## ç”Ÿäº§ç¯å¢ƒé…ç½®

<VersionBadge version="2.13.0" />

åœ¨ç”Ÿäº§éƒ¨ç½²ä¸­ï¼Œä¸ºäº†åœ¨æœåŠ¡å™¨é‡å¯åä»èƒ½ä¿ç•™ä»¤ç‰Œï¼Œè¯·åŒæ—¶é…ç½® `jwt_signing_key` ä¸ `client_storage`ï¼š

```python server.py
import os
from fastmcp import FastMCP
from fastmcp.server.auth.providers.workos import WorkOSProvider
from key_value.aio.stores.redis import RedisStore
from key_value.aio.wrappers.encryption import FernetEncryptionWrapper
from cryptography.fernet import Fernet

# ä½¿ç”¨åŠ å¯†çš„æŒä¹…åŒ–ä»¤ç‰Œå­˜å‚¨è¿›è¡Œç”Ÿäº§é…ç½®
auth = WorkOSProvider(
    client_id="client_YOUR_CLIENT_ID",
    client_secret="YOUR_CLIENT_SECRET",
    authkit_domain="https://your-app.authkit.app",
    base_url="https://your-production-domain.com",
    required_scopes=["openid", "profile", "email"],

    # ç”Ÿäº§ç¯å¢ƒä»¤ç‰Œç®¡ç†
    jwt_signing_key=os.environ["JWT_SIGNING_KEY"],
    client_storage=FernetEncryptionWrapper(
        key_value=RedisStore(
            host=os.environ["REDIS_HOST"],
            port=int(os.environ["REDIS_PORT"])
        ),
        fernet=Fernet(os.environ["STORAGE_ENCRYPTION_KEY"])
    )
)

mcp = FastMCP(name="Production WorkOS App", auth=auth)
```

<Note>
`jwt_signing_key` ä¸ `client_storage` éœ€è¦é…åˆä½¿ç”¨ï¼Œæ‰èƒ½åœ¨æœåŠ¡å™¨é‡å¯åä¿ç•™ä»¤ç‰Œä¸å®¢æˆ·ç«¯æ³¨å†Œä¿¡æ¯ã€‚**è¯·ä½¿ç”¨ `FernetEncryptionWrapper` åŠ å¯†å­˜å‚¨ä¸­çš„æ•æ„Ÿ OAuth ä»¤ç‰Œ**ï¼Œå¦åˆ™å°†ä»¥æ˜æ–‡ä¿å­˜ã€‚å»ºè®®é€šè¿‡ç¯å¢ƒå˜é‡ä¼ é€’å¯†é’¥ï¼Œå¹¶ä½¿ç”¨ Redis ç­‰æŒä¹…åŒ–åç«¯ä»¥æ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²ã€‚

æ›´å¤šå‚æ•°è¯¦æƒ…è¯·å‚é˜… [OAuth ä»£ç†æ–‡æ¡£](/zh/servers/auth/oauth-proxy#configuration-parameters)ã€‚
</Note>

## ç¯å¢ƒå˜é‡

<VersionBadge version="2.12.1" />

å¯¹äºç”Ÿäº§éƒ¨ç½²ï¼Œè¯·ä½¿ç”¨ç¯å¢ƒå˜é‡è€Œä¸æ˜¯ç¡¬ç¼–ç å‡­æ®ã€‚

### æä¾›ç¨‹åºé€‰æ‹©

è®¾ç½®æ­¤ç¯å¢ƒå˜é‡å…è®¸è‡ªåŠ¨ä½¿ç”¨ WorkOS æä¾›ç¨‹åºï¼Œè€Œæ— éœ€åœ¨ä»£ç ä¸­æ˜¾å¼å®ä¾‹åŒ–å®ƒã€‚

<Card>
<ParamField path="FASTMCP_SERVER_AUTH" default="æœªè®¾ç½®">
è®¾ç½®ä¸º `fastmcp.server.auth.providers.workos.WorkOSProvider` ä»¥ä½¿ç”¨ WorkOS èº«ä»½éªŒè¯ã€‚
</ParamField>
</Card>

### WorkOS ç‰¹å®šé…ç½®

è¿™äº›ç¯å¢ƒå˜é‡ä¸º WorkOS æä¾›ç¨‹åºæä¾›é»˜è®¤å€¼ï¼Œæ— è®ºå®ƒæ˜¯æ‰‹åŠ¨å®ä¾‹åŒ–çš„è¿˜æ˜¯é€šè¿‡ `FASTMCP_SERVER_AUTH` é…ç½®çš„ã€‚

<Card>
<ParamField path="FASTMCP_SERVER_AUTH_WORKOS_CLIENT_ID" required>
æ‚¨çš„ WorkOS OAuth åº”ç”¨å®¢æˆ·ç«¯ IDï¼ˆä¾‹å¦‚ï¼Œ`client_01K33Y6GGS7T3AWMPJWKW42Y3Q`ï¼‰
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_WORKOS_CLIENT_SECRET" required>
æ‚¨çš„ WorkOS OAuth åº”ç”¨å®¢æˆ·ç«¯å¯†é’¥
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_WORKOS_AUTHKIT_DOMAIN" required>
æ‚¨çš„ WorkOS AuthKit åŸŸï¼ˆä¾‹å¦‚ï¼Œ`https://your-app.authkit.app`ï¼‰
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_WORKOS_BASE_URL" default="http://localhost:8000">
OAuth ç«¯ç‚¹å¯è®¿é—®çš„å…¬å…± URLï¼ˆåŒ…å«ä»»ä½•æŒ‚è½½è·¯å¾„ï¼‰
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_WORKOS_ISSUER_URL" default="ä½¿ç”¨ BASE_URL">
ç”¨äº OAuth å…ƒæ•°æ®çš„ Issuer URLï¼ˆé»˜è®¤ç­‰äº `BASE_URL`ï¼‰ã€‚å½“æŒ‚è½½åœ¨è·¯å¾„å‰ç¼€ä¸‹æ—¶ï¼Œè¯·è®¾ç½®ä¸ºæ ¹çº§ URL ä»¥é¿å… 404 æ—¥å¿—ã€‚è¯¦è§ [HTTP éƒ¨ç½²æŒ‡å—](/zh/deployment/http#mounting-authenticated-servers)ã€‚
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_WORKOS_REDIRECT_PATH" default="/auth/callback">
åœ¨æ‚¨çš„ WorkOS OAuth åº”ç”¨ä¸­é…ç½®çš„é‡å®šå‘è·¯å¾„
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_WORKOS_REQUIRED_SCOPES" default="[]">
å¿…éœ€çš„ OAuth ä½œç”¨åŸŸçš„é€—å·ã€ç©ºæ ¼æˆ– JSON åˆ†éš”åˆ—è¡¨ï¼ˆä¾‹å¦‚ï¼Œ`openid profile email` æˆ– `["openid","profile","email"]`ï¼‰
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_WORKOS_TIMEOUT_SECONDS" default="10">
WorkOS API è°ƒç”¨çš„ HTTP è¯·æ±‚è¶…æ—¶
</ParamField>
</Card>

ç¤ºä¾‹ `.env` æ–‡ä»¶ï¼š
```bash
# WorkOS OAuth å‡­æ®ï¼ˆå§‹ç»ˆç”¨ä½œé»˜è®¤å€¼ï¼‰
FASTMCP_SERVER_AUTH_WORKOS_CLIENT_ID=client_01K33Y6GGS7T3AWMPJWKW42Y3Q
FASTMCP_SERVER_AUTH_WORKOS_CLIENT_SECRET=your_client_secret
FASTMCP_SERVER_AUTH_WORKOS_AUTHKIT_DOMAIN=https://your-app.authkit.app
FASTMCP_SERVER_AUTH_WORKOS_BASE_URL=https://your-server.com
FASTMCP_SERVER_AUTH_WORKOS_REQUIRED_SCOPES=["openid","profile","email"]

# å¯é€‰ï¼šä¸ºæ‰€æœ‰æœåŠ¡å™¨è‡ªåŠ¨é…ç½® WorkOS èº«ä»½éªŒè¯
FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.workos.WorkOSProvider
```

è®¾ç½®ç¯å¢ƒå˜é‡åï¼Œæ‚¨å¯ä»¥é€‰æ‹©ï¼š

**é€‰é¡¹ 1ï¼šæ‰‹åŠ¨å®ä¾‹åŒ–ï¼ˆç¯å¢ƒå˜é‡æä¾›é»˜è®¤å€¼ï¼‰**
```python server.py
from fastmcp import FastMCP
from fastmcp.server.auth.providers.workos import WorkOSProvider

# ç¯å¢ƒå˜é‡ä¸º WorkOSProvider() æä¾›é»˜è®¤å€¼
auth = WorkOSProvider()  # ä½¿ç”¨ç¯å¢ƒå˜é‡é»˜è®¤å€¼
mcp = FastMCP(name="WorkOS å—ä¿æŠ¤æœåŠ¡å™¨", auth=auth)
```

**é€‰é¡¹ 2ï¼šè‡ªåŠ¨é…ç½®ï¼ˆéœ€è¦ FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.workos.WorkOSProviderï¼‰**
```python server.py
from fastmcp import FastMCP

# èº«ä»½éªŒè¯ä» FASTMCP_SERVER_AUTH è‡ªåŠ¨é…ç½®
mcp = FastMCP(name="WorkOS å—ä¿æŠ¤æœåŠ¡å™¨")
```

## é…ç½®é€‰é¡¹

<Card>
<ParamField path="client_id" required>
WorkOS OAuth åº”ç”¨ç¨‹åºå®¢æˆ·ç«¯ ID
</ParamField>

<ParamField path="client_secret" required>
WorkOS OAuth åº”ç”¨ç¨‹åºå®¢æˆ·ç«¯å¯†é’¥
</ParamField>

<ParamField path="authkit_domain" required>
æ‚¨çš„ WorkOS AuthKit åŸŸ URLï¼ˆä¾‹å¦‚ï¼Œ`https://your-app.authkit.app`ï¼‰
</ParamField>

<ParamField path="base_url" required>
æ‚¨çš„ FastMCP æœåŠ¡å™¨çš„å…¬å…± URL
</ParamField>

<ParamField path="required_scopes" default="[]">
è¦è¯·æ±‚çš„ OAuth ä½œç”¨åŸŸ
</ParamField>

<ParamField path="redirect_path" default="/auth/callback">
OAuth å›è°ƒè·¯å¾„
</ParamField>

<ParamField path="timeout_seconds" default="10">
API è¯·æ±‚è¶…æ—¶
</ParamField>
</Card>