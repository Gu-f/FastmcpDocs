---
title: Eunomia èº«ä»½è®¤è¯ ğŸ¤ FastMCP
sidebarTitle: Eunomia Auth
description: ä½¿ç”¨ Eunomia ä¸ºæ‚¨çš„ FastMCP æœåŠ¡å™¨æ·»åŠ åŸºäºç­–ç•¥çš„æˆæƒ
icon: shield-check
---

ä½¿ç”¨ **[Eunomia][eunomia-github] æˆæƒä¸­é—´ä»¶**é€šè¿‡ä¸€è¡Œä»£ç æ·»åŠ ä¸ºæ‚¨çš„ FastMCP æœåŠ¡å™¨æ·»åŠ **åŸºäºç­–ç•¥çš„æˆæƒ**ã€‚

æ§åˆ¶ MCP å®¢æˆ·ç«¯å¯ä»¥åœ¨æ‚¨çš„æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹å’Œæ‰§è¡Œçš„å·¥å…·ã€èµ„æºå’Œæç¤ºã€‚å®šä¹‰åŠ¨æ€çš„åŸºäº JSON çš„ç­–ç•¥ï¼Œå¹¶è·å¾—æ‰€æœ‰è®¿é—®å°è¯•å’Œè¿è§„è¡Œä¸ºçš„å…¨é¢å®¡è®¡æ—¥å¿—ã€‚

## å·¥ä½œåŸç†

åˆ©ç”¨ FastMCP çš„[Middleware][fastmcp-middleare]ï¼ŒEunomia ä¸­é—´ä»¶æ‹¦æˆªæ‰€æœ‰åˆ°æ‚¨æœåŠ¡å™¨çš„ MCP è¯·æ±‚ï¼Œå¹¶è‡ªåŠ¨å°† MCP æ–¹æ³•æ˜ å°„åˆ°æˆæƒæ£€æŸ¥ã€‚

### åˆ—è¡¨æ“ä½œ

ä¸­é—´ä»¶ä½œä¸ºåˆ—è¡¨æ“ä½œï¼ˆ`tools/list`ã€`resources/list`ã€`prompts/list`ï¼‰çš„è¿‡æ»¤å™¨ï¼Œå¯¹å®¢æˆ·ç«¯éšè—æœªç”±å®šä¹‰ç­–ç•¥æˆæƒçš„ç»„ä»¶ã€‚

```mermaid
sequenceDiagram
    participant MCPClient as MCP å®¢æˆ·ç«¯
    participant EunomiaMiddleware as Eunomia ä¸­é—´ä»¶
    participant MCPServer as FastMCP æœåŠ¡å™¨
    participant EunomiaServer as Eunomia æœåŠ¡å™¨

    MCPClient->>EunomiaMiddleware: MCP åˆ—è¡¨è¯·æ±‚ (ä¾‹å¦‚ï¼štools/list)
    EunomiaMiddleware->>MCPServer: MCP åˆ—è¡¨è¯·æ±‚
    MCPServer-->>EunomiaMiddleware: MCP åˆ—è¡¨å“åº”
    EunomiaMiddleware->>EunomiaServer: æˆæƒæ£€æŸ¥
    EunomiaServer->>EunomiaMiddleware: æˆæƒå†³ç­–
    EunomiaMiddleware-->>MCPClient: è¿‡æ»¤åçš„ MCP åˆ—è¡¨å“åº”
```

### æ‰§è¡Œæ“ä½œ

ä¸­é—´ä»¶ä½œä¸ºæ‰§è¡Œæ“ä½œï¼ˆ`tools/call`ã€`resources/read`ã€`prompts/get`ï¼‰çš„é˜²ç«å¢™ï¼Œé˜»æ­¢æœªç”±å®šä¹‰ç­–ç•¥æˆæƒçš„æ“ä½œã€‚

```mermaid
sequenceDiagram
    participant MCPClient as MCP å®¢æˆ·ç«¯
    participant EunomiaMiddleware as Eunomia ä¸­é—´ä»¶
    participant MCPServer as FastMCP æœåŠ¡å™¨
    participant EunomiaServer as Eunomia æœåŠ¡å™¨

    MCPClient->>EunomiaMiddleware: MCP æ‰§è¡Œè¯·æ±‚ (ä¾‹å¦‚ï¼štools/call)
    EunomiaMiddleware->>EunomiaServer: æˆæƒæ£€æŸ¥
    EunomiaServer->>EunomiaMiddleware: æˆæƒå†³ç­–
    EunomiaMiddleware-->>MCPClient: MCP æœªæˆæƒé”™è¯¯ (å¦‚æœæ‹’ç»)
    EunomiaMiddleware->>MCPServer: MCP æ‰§è¡Œè¯·æ±‚ (å¦‚æœå…è®¸)
    MCPServer-->>EunomiaMiddleware: MCP æ‰§è¡Œå“åº” (å¦‚æœå…è®¸)
    EunomiaMiddleware-->>MCPClient: MCP æ‰§è¡Œå“åº” (å¦‚æœå…è®¸)
```

## ä¸ºæ‚¨çš„æœåŠ¡å™¨æ·»åŠ æˆæƒ

<Note>
Eunomia æ˜¯ä¸€ä¸ªä¸“é—¨å¤„ç†ç­–ç•¥å†³ç­–çš„ AI ç‰¹å®šæˆæƒæœåŠ¡å™¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨åµŒå…¥åœ¨æ‚¨çš„ MCP æœåŠ¡å™¨å†…è¿è¡Œï¼Œå®ç°é›¶é…ç½®ï¼Œä½†ä¹Ÿå¯ä»¥è¿œç¨‹è¿è¡Œä»¥å®ç°é›†ä¸­å¼ç­–ç•¥å†³ç­–ã€‚

</Note>

### åˆ›å»ºå¸¦æœ‰æˆæƒçš„æœåŠ¡å™¨

é¦–å…ˆï¼Œå®‰è£… `eunomia-mcp` åŒ…ï¼š

```bash
pip install eunomia-mcp
```

ç„¶ååˆ›å»ºä¸€ä¸ª FastMCP æœåŠ¡å™¨å¹¶åœ¨ä¸€è¡Œä¸­æ·»åŠ  Eunomia ä¸­é—´ä»¶ï¼š

```python server.py
from fastmcp import FastMCP
from eunomia_mcp import create_eunomia_middleware

# åˆ›å»ºæ‚¨çš„ FastMCP æœåŠ¡å™¨
mcp = FastMCP("å®‰å…¨ MCP æœåŠ¡å™¨ ğŸ”’")

@mcp.tool()
def add(a: int, b: int) -> int:
    """å°†ä¸¤ä¸ªæ•°å­—ç›¸åŠ """
    return a + b

# ä¸ºæ‚¨çš„æœåŠ¡å™¨æ·»åŠ ä¸­é—´ä»¶
middleware = create_eunomia_middleware(policy_file="mcp_policies.json")
mcp.add_middleware(middleware)

if __name__ == "__main__":
    mcp.run()
```

### é…ç½®è®¿é—®ç­–ç•¥

åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨ `eunomia-mcp` CLI æ¥ç®¡ç†æ‚¨çš„æˆæƒç­–ç•¥ï¼š

```bash
# åˆ›å»ºé»˜è®¤ç­–ç•¥æ–‡ä»¶
eunomia-mcp init

# æˆ–è€…ä¸ºæ‚¨çš„ FastMCP æœåŠ¡å™¨åˆ›å»ºè‡ªå®šä¹‰ç­–ç•¥æ–‡ä»¶
eunomia-mcp init --custom-mcp "app.server:mcp"
```

è¿™å°†åˆ›å»º `mcp_policies.json` æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥æ ¹æ®è®¿é—®æ§åˆ¶éœ€è¦è¿›ä¸€æ­¥ç¼–è¾‘ã€‚

```bash
# ç¼–è¾‘å®Œæˆåï¼ŒéªŒè¯æ‚¨çš„ç­–ç•¥æ–‡ä»¶
eunomia-mcp validate mcp_policies.json
```

### è¿è¡ŒæœåŠ¡å™¨

æ­£å¸¸å¯åŠ¨æ‚¨çš„ FastMCP æœåŠ¡å™¨ï¼š

```bash
python server.py
```

ä¸­é—´ä»¶ç°åœ¨å°†æ‹¦æˆªæ‰€æœ‰ MCP è¯·æ±‚å¹¶æ ¹æ®æ‚¨çš„ç­–ç•¥æ£€æŸ¥å®ƒä»¬ã€‚è¯·æ±‚åŒ…æ‹¬é€šè¿‡ `X-Agent-ID`ã€`X-User-ID`ã€`User-Agent` æˆ– `Authorization` ç­‰æ ‡å¤´çš„ä»£ç†è¯†åˆ«ï¼Œä»¥åŠ MCP æ–¹æ³•åˆ°æˆæƒèµ„æºå’Œæ“ä½œçš„è‡ªåŠ¨æ˜ å°„ã€‚

<Tip>
  æœ‰å…³è¯¦ç»†çš„ç­–ç•¥é…ç½®ã€è‡ªå®šä¹‰èº«ä»½éªŒè¯å’Œè¿œç¨‹éƒ¨ç½²ï¼Œè¯·è®¿é—® [Eunomia MCP ä¸­é—´ä»¶ä»“åº“][eunomia-mcp-github]ã€‚
</Tip>

[eunomia-github]: https://github.com/whataboutyou-ai/eunomia
[eunomia-mcp-github]: https://github.com/whataboutyou-ai/eunomia/tree/main/pkgs/extensions/mcp
[fastmcp-middleare]: /servers/middleware
