---
title: Auth0 OAuth ğŸ¤ FastMCP
sidebarTitle: Auth0
description: ä½¿ç”¨ Auth0 OAuth ä¿æŠ¤æ‚¨çš„ FastMCP æœåŠ¡å™¨
icon: shield-check
tag: NEW
---

import { VersionBadge } from "/snippets/version-badge.mdx"

<VersionBadge version="2.12.4" />

æœ¬æŒ‡å—å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨ **Auth0 OAuth** ä¿æŠ¤æ‚¨çš„ FastMCP æœåŠ¡å™¨ã€‚è™½ç„¶ Auth0 æ”¯æŒåŠ¨æ€å®¢æˆ·ç«¯æ³¨å†Œï¼Œä½†é»˜è®¤æƒ…å†µä¸‹æœªå¯ç”¨ï¼Œå› æ­¤æ­¤é›†æˆä½¿ç”¨ [**OIDC ä»£ç†**](/zh/servers/auth/oidc-proxy) æ¨¡å¼æ¥æ¡¥æ¥ Auth0 çš„åŠ¨æ€ OIDC é…ç½®ä¸ MCP çš„èº«ä»½éªŒè¯éœ€æ±‚ã€‚

## é…ç½®

### å‰ææ¡ä»¶

å¼€å§‹ä¹‹å‰ï¼Œæ‚¨éœ€è¦ï¼š
1. ä¸€ä¸ªæœ‰æƒé™åˆ›å»ºåº”ç”¨ç¨‹åºçš„ **[Auth0 è´¦æˆ·](https://auth0.com/)**
2. æ‚¨çš„ FastMCP æœåŠ¡å™¨ URLï¼ˆå¼€å‘ç¯å¢ƒå¯ä»¥æ˜¯ localhostï¼Œä¾‹å¦‚ `http://localhost:8000`ï¼‰

### æ­¥éª¤ 1ï¼šåˆ›å»º Auth0 åº”ç”¨ç¨‹åº

åœ¨æ‚¨çš„ Auth0 è®¾ç½®ä¸­åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºä»¥è·å–èº«ä»½éªŒè¯æ‰€éœ€çš„å‡­æ®ï¼š

<Steps>
<Step title="å¯¼èˆªåˆ°åº”ç”¨ç¨‹åº">
    åœ¨æ‚¨çš„ Auth0 è´¦æˆ·ä¸­è½¬åˆ° **Applications â†’ Applications**ã€‚

    ç‚¹å‡» **"+ Create Application"** åˆ›å»ºæ–°åº”ç”¨ç¨‹åºã€‚
</Step>

<Step title="åˆ›å»ºæ‚¨çš„åº”ç”¨ç¨‹åº">
    - **åç§°**: é€‰æ‹©ç”¨æˆ·èƒ½è¯†åˆ«çš„åç§°ï¼ˆä¾‹å¦‚ï¼Œ"My FastMCP Server"ï¼‰
    - **é€‰æ‹©åº”ç”¨ç¨‹åºç±»å‹**: é€‰æ‹© "Single Page Web Applications"
    - ç‚¹å‡» **Create** åˆ›å»ºåº”ç”¨ç¨‹åº
</Step>

<Step title="é…ç½®æ‚¨çš„åº”ç”¨ç¨‹åº">
    é€‰æ‹©æ‚¨åº”ç”¨ç¨‹åºçš„ "Settings" æ ‡ç­¾ï¼Œç„¶åæ‰¾åˆ° "Application URIs" éƒ¨åˆ†ã€‚

    - **Allowed Callback URLs**: æ‚¨çš„æœåŠ¡å™¨ URL + `/auth/callback`ï¼ˆä¾‹å¦‚ï¼Œ`http://localhost:8000/auth/callback`ï¼‰
    - ç‚¹å‡» **Save** ä¿å­˜æ‚¨çš„æ›´æ”¹

    <Warning>
    å›è°ƒ URL å¿…é¡»å®Œå…¨åŒ¹é…ã€‚é»˜è®¤è·¯å¾„æ˜¯ `/auth/callback`ï¼Œä½†æ‚¨å¯ä»¥ä½¿ç”¨ `redirect_path` å‚æ•°è‡ªå®šä¹‰å®ƒã€‚
    </Warning>

    <Tip>
    å¦‚æœæ‚¨æƒ³ä½¿ç”¨è‡ªå®šä¹‰å›è°ƒè·¯å¾„ï¼ˆä¾‹å¦‚ï¼Œ`/auth/auth0/callback`ï¼‰ï¼Œè¯·ç¡®ä¿åœ¨ Auth0 åº”ç”¨ç¨‹åºè®¾ç½®å’Œé…ç½® Auth0Provider æ—¶çš„ `redirect_path` å‚æ•°ä¸­è®¾ç½®ç›¸åŒçš„è·¯å¾„ã€‚
    </Tip>
</Step>

<Step title="ä¿å­˜æ‚¨çš„å‡­æ®">
    åˆ›å»ºåº”ç”¨ç¨‹åºåï¼Œåœ¨ "Basic Information" éƒ¨åˆ†æ‚¨å°†çœ‹åˆ°ï¼š

    - **Client ID**: ç±»ä¼¼ `tv2ObNgaZAWWhhycr7Bz1LU2mxlnsmsB` çš„å…¬å…±æ ‡è¯†ç¬¦
    - **Client Secret**: åº”å§‹ç»ˆå®‰å…¨å­˜å‚¨çš„ç§æœ‰éšè—å€¼

    <Tip>
    å®‰å…¨å­˜å‚¨è¿™äº›å‡­æ®ã€‚æ°¸è¿œä¸è¦å°†å®ƒä»¬æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†å™¨ã€‚
    </Tip>
</Step>

<Step title="é€‰æ‹©æ‚¨çš„å—ä¼—">
  åœ¨æ‚¨çš„ Auth0 è´¦æˆ·ä¸­è½¬åˆ° **Applications â†’ APIs**ã€‚

    - æ‰¾åˆ°æ‚¨æƒ³ä¸ºåº”ç”¨ç¨‹åºä½¿ç”¨çš„ API
    - **API Audience**: å”¯ä¸€æ ‡è¯† API çš„ URL

    <Tip>
    å°†æ­¤ä¸ä¸Šè¿°å‡­æ®ä¸€èµ·å­˜å‚¨ã€‚æ°¸è¿œä¸è¦å°†å…¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†å™¨ã€‚
    </Tip>
</Step>
</Steps>

### æ­¥éª¤ 2ï¼šFastMCP é…ç½®

ä½¿ç”¨ `Auth0Provider` åˆ›å»ºæ‚¨çš„ FastMCP æœåŠ¡å™¨ã€‚

```python server.py
from fastmcp import FastMCP
from fastmcp.server.auth.providers.auth0 import Auth0Provider

# Auth0Provider ä½¿ç”¨ Auth0 OIDC é…ç½®
auth_provider = Auth0Provider(
    config_url="https://.../.well-known/openid-configuration",  # æ‚¨çš„ Auth0 é…ç½® URL
    client_id="tv2ObNgaZAWWhhycr7Bz1LU2mxlnsmsB",               # æ‚¨çš„ Auth0 åº”ç”¨ç¨‹åºå®¢æˆ·ç«¯ ID
    client_secret="vPYqbjemq...",                               # æ‚¨çš„ Auth0 åº”ç”¨ç¨‹åºå®¢æˆ·ç«¯å¯†é’¥
    audience="https://...",                                     # æ‚¨çš„ Auth0 API å—ä¼—
    base_url="http://localhost:8000",                           # å¿…é¡»ä¸æ‚¨çš„åº”ç”¨ç¨‹åºé…ç½®åŒ¹é…
    # redirect_path="/auth/callback"                            # é»˜è®¤å€¼ï¼Œå¦‚éœ€è¦å¯è‡ªå®šä¹‰
)

mcp = FastMCP(name="Auth0 Secured App", auth=auth_provider)

# æ·»åŠ ä¸€ä¸ªå—ä¿æŠ¤çš„å·¥å…·æ¥æµ‹è¯•èº«ä»½éªŒè¯
@mcp.tool
async def get_token_info() -> dict:
    """è¿”å›å…³äº Auth0 ä»¤ç‰Œçš„ä¿¡æ¯ã€‚"""
    from fastmcp.server.dependencies import get_access_token

    token = get_access_token()

    return {
        "issuer": token.claims.get("iss"),
        "audience": token.claims.get("aud"),
        "scope": token.claims.get("scope")
    }
```

## æµ‹è¯•

### è¿è¡ŒæœåŠ¡å™¨

ä½¿ç”¨ HTTP ä¼ è¾“å¯åŠ¨æ‚¨çš„ FastMCP æœåŠ¡å™¨ä»¥å¯ç”¨ OAuth æµç¨‹ï¼š

```bash
fastmcp run server.py --transport http --port 8000
```

æ‚¨çš„æœåŠ¡å™¨ç°åœ¨æ­£åœ¨è¿è¡Œå¹¶å—åˆ° Auth0 èº«ä»½éªŒè¯ä¿æŠ¤ã€‚

### ä½¿ç”¨å®¢æˆ·ç«¯æµ‹è¯•

åˆ›å»ºä¸€ä¸ªä¸æ‚¨çš„ Auth0 ä¿æŠ¤æœåŠ¡å™¨è¿›è¡Œèº«ä»½éªŒè¯çš„æµ‹è¯•å®¢æˆ·ç«¯ï¼š

```python test_client.py
from fastmcp import Client
import asyncio

async def main():
    # å®¢æˆ·ç«¯å°†è‡ªåŠ¨å¤„ç† Auth0 OAuth æµç¨‹
    async with Client("http://localhost:8000/mcp/", auth="oauth") as client:
        # é¦–æ¬¡è¿æ¥å°†åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­æ‰“å¼€ Auth0 ç™»å½•é¡µé¢
        print("âœ“ å·²é€šè¿‡ Auth0 è®¤è¯ï¼")

        # æµ‹è¯•å—ä¿æŠ¤çš„å·¥å…·
        result = await client.call_tool("get_token_info")
        print(f"Auth0 å—ä¼—: {result['audience']}")

if __name__ == "__main__":
    asyncio.run(main())
```

å½“æ‚¨é¦–æ¬¡è¿è¡Œå®¢æˆ·ç«¯æ—¶ï¼š
1. æ‚¨çš„æµè§ˆå™¨å°†æ‰“å¼€ Auth0 çš„æˆæƒé¡µé¢
2. æˆæƒåº”ç”¨ç¨‹åºåï¼Œæ‚¨å°†è¢«é‡å®šå‘å›æ¥
3. å®¢æˆ·ç«¯æ¥æ”¶ä»¤ç‰Œå¹¶å¯ä»¥è¿›è¡Œèº«ä»½éªŒè¯è¯·æ±‚

## ç”Ÿäº§ç¯å¢ƒé…ç½®

<VersionBadge version="2.13.0" />

åœ¨ç”Ÿäº§éƒ¨ç½²ä¸­ï¼Œä¸ºäº†åœ¨æœåŠ¡å™¨é‡å¯åä»èƒ½ä¿ç•™ä»¤ç‰Œï¼Œéœ€åŒæ—¶é…ç½® `jwt_signing_key` ä¸ `client_storage`ï¼š

```python server.py
import os
from fastmcp import FastMCP
from fastmcp.server.auth.providers.auth0 import Auth0Provider
from key_value.aio.stores.redis import RedisStore
from key_value.aio.wrappers.encryption import FernetEncryptionWrapper
from cryptography.fernet import Fernet

# ä½¿ç”¨åŠ å¯†çš„æŒä¹…åŒ–ä»¤ç‰Œå­˜å‚¨è¿›è¡Œç”Ÿäº§é…ç½®
auth_provider = Auth0Provider(
    config_url="https://.../.well-known/openid-configuration",
    client_id="tv2ObNgaZAWWhhycr7Bz1LU2mxlnsmsB",
    client_secret="vPYqbjemq...",
    audience="https://...",
    base_url="https://your-production-domain.com",

    # ç”Ÿäº§ç¯å¢ƒä»¤ç‰Œç®¡ç†
    jwt_signing_key=os.environ["JWT_SIGNING_KEY"],
    client_storage=FernetEncryptionWrapper(
        key_value=RedisStore(
            host=os.environ["REDIS_HOST"],
            port=int(os.environ["REDIS_PORT"])
        ),
        fernet=Fernet(os.environ["STORAGE_ENCRYPTION_KEY"])
    )
)

mcp = FastMCP(name="Production Auth0 App", auth=auth_provider)
```

<Note>
`jwt_signing_key` ä¸ `client_storage` éœ€è¦é…å¥—ä½¿ç”¨ï¼Œä»¥ç¡®ä¿ä»¤ç‰Œä¸å®¢æˆ·ç«¯æ³¨å†Œåœ¨æœåŠ¡å™¨é‡å¯åä»ç„¶æœ‰æ•ˆã€‚**è¯·ä½¿ç”¨ `FernetEncryptionWrapper` å¯¹å­˜å‚¨ä¸­çš„æ•æ„Ÿ OAuth ä»¤ç‰Œè¿›è¡ŒåŠ å¯†**ï¼Œå¦åˆ™å°†ä»¥æ˜æ–‡å½¢å¼ä¿å­˜ã€‚å»ºè®®ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜æ”¾å¯†é’¥ï¼Œå¹¶é€‰æ‹© Redis ç­‰æŒä¹…åŒ–åç«¯ä»¥æ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²ã€‚

æ›´å¤šå‚æ•°è¯´æ˜è¯·å‚é˜… [OAuth ä»£ç†æ–‡æ¡£](/zh/servers/auth/oauth-proxy#configuration-parameters)ã€‚
</Note>

<Info>
å®¢æˆ·ç«¯åœ¨æœ¬åœ°ç¼“å­˜ä»¤ç‰Œï¼Œå› æ­¤é™¤éä»¤ç‰Œè¿‡æœŸæˆ–æ‚¨æ˜ç¡®æ¸…é™¤ç¼“å­˜ï¼Œå¦åˆ™åç»­è¿è¡Œæ—¶æ— éœ€é‡æ–°è®¤è¯ã€‚
</Info>

## ç¯å¢ƒå˜é‡

å¯¹äºç”Ÿäº§éƒ¨ç½²ï¼Œä½¿ç”¨ç¯å¢ƒå˜é‡è€Œä¸æ˜¯ç¡¬ç¼–ç å‡­æ®ã€‚

### æä¾›è€…é€‰æ‹©

è®¾ç½®æ­¤ç¯å¢ƒå˜é‡å…è®¸è‡ªåŠ¨ä½¿ç”¨ Auth0 æä¾›è€…ï¼Œè€Œæ— éœ€åœ¨ä»£ç ä¸­æ˜¾å¼å®ä¾‹åŒ–å®ƒã€‚

<Card>
<ParamField path="FASTMCP_SERVER_AUTH" default="Not set">
è®¾ç½®ä¸º `fastmcp.server.auth.providers.auth0.Auth0Provider` ä»¥ä½¿ç”¨ Auth0 èº«ä»½éªŒè¯ã€‚
</ParamField>
</Card>

### Auth0 ç‰¹å®šé…ç½®

è¿™äº›ç¯å¢ƒå˜é‡ä¸º Auth0 æä¾›è€…æä¾›é»˜è®¤å€¼ï¼Œæ— è®ºæ˜¯æ‰‹åŠ¨å®ä¾‹åŒ–è¿˜æ˜¯é€šè¿‡ `FASTMCP_SERVER_AUTH` é…ç½®ã€‚

<Card>
<ParamField path="FASTMCP_SERVER_AUTH_AUTH0_CONFIG_URL" required>
æ‚¨çš„ Auth0 åº”ç”¨ç¨‹åºé…ç½® URLï¼ˆä¾‹å¦‚ï¼Œ`https://.../.well-known/openid-configuration`ï¼‰
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_AUTH0_CLIENT_ID" required>
æ‚¨çš„ Auth0 åº”ç”¨ç¨‹åºå®¢æˆ·ç«¯ IDï¼ˆä¾‹å¦‚ï¼Œ`tv2ObNgaZAWWhhycr7Bz1LU2mxlnsmsB`ï¼‰
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_AUTH0_CLIENT_SECRET" required>
æ‚¨çš„ Auth0 åº”ç”¨ç¨‹åºå®¢æˆ·ç«¯å¯†é’¥ï¼ˆä¾‹å¦‚ï¼Œ`vPYqbjemq...`ï¼‰
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_AUTH0_AUDIENCE" required>
æ‚¨çš„ Auth0 API å—ä¼—
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_AUTH0_BASE_URL" required>
OAuth ç«¯ç‚¹å¯è®¿é—®çš„å…¬å…± URLï¼ˆåŒ…å«ä»»ä½•æŒ‚è½½è·¯å¾„ï¼‰
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_AUTH0_ISSUER_URL" default="ä½¿ç”¨ BASE_URL">
ç”¨äº OAuth å…ƒæ•°æ®çš„ Issuer URLï¼ˆé»˜è®¤ç­‰äº `BASE_URL`ï¼‰ã€‚å½“æŒ‚è½½åœ¨è·¯å¾„å‰ç¼€ä¸‹æ—¶ï¼Œè¯·è®¾ç½®ä¸ºæ ¹çº§ URL ä»¥é¿å… 404 æ—¥å¿—ã€‚è¯¦è§ [HTTP éƒ¨ç½²æŒ‡å—](/zh/deployment/http#mounting-authenticated-servers)ã€‚
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_AUTH0_REDIRECT_PATH" default="/auth/callback">
åœ¨æ‚¨çš„ Auth0 åº”ç”¨ç¨‹åºä¸­é…ç½®çš„é‡å®šå‘è·¯å¾„
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_AUTH0_REQUIRED_SCOPES" default='["openid"]'>
é€—å·ã€ç©ºæ ¼æˆ– JSON åˆ†éš”çš„æ‰€éœ€ Auth0 ä½œç”¨åŸŸåˆ—è¡¨ï¼ˆä¾‹å¦‚ï¼Œ`openid email` æˆ– `["openid","email"]`ï¼‰
</ParamField>
</Card>

Example `.env` file:
```bash
# ä½¿ç”¨ Auth0 æä¾›è€…
FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.auth0.Auth0Provider

# Auth0 é…ç½®å’Œå‡­æ®
FASTMCP_SERVER_AUTH_AUTH0_CONFIG_URL=https://.../.well-known/openid-configuration
FASTMCP_SERVER_AUTH_AUTH0_CLIENT_ID=tv2ObNgaZAWWhhycr7Bz1LU2mxlnsmsB
FASTMCP_SERVER_AUTH_AUTH0_CLIENT_SECRET=vPYqbjemq...
FASTMCP_SERVER_AUTH_AUTH0_AUDIENCE=https://...
FASTMCP_SERVER_AUTH_AUTH0_BASE_URL=https://your-server.com
FASTMCP_SERVER_AUTH_AUTH0_REQUIRED_SCOPES=openid,email
```

With environment variables set, your server code simplifies to:

```python server.py
from fastmcp import FastMCP

# èº«ä»½éªŒè¯è‡ªåŠ¨ä»ç¯å¢ƒä¸­é…ç½®
mcp = FastMCP(name="Auth0 Secured App")

@mcp.tool
async def search_logs() -> list[str]:
    """æœç´¢æœåŠ¡æ—¥å¿—ã€‚"""
    # æ‚¨çš„å·¥å…·å®ç°åœ¨è¿™é‡Œ
    pass
```
