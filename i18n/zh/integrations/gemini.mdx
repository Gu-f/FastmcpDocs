---
title: Gemini SDK 🤝 FastMCP
sidebarTitle: Gemini SDK
description: 将 FastMCP 服务器连接到 Google Gemini SDK 中
icon: message-code
---

import { VersionBadge } from "/snippets/version-badge.mdx"

Google 的 Gemini API 在其 Python 和 JavaScript SDK 中包含对 MCP 服务器的内置支持，允许您直接连接到 MCP 服务器，并与 Gemini 模型无缝使用它们的工具。

## Gemini Python SDK

Google 的 [Gemini Python SDK](https://ai.google.dev/gemini-api/docs) 可以直接使用 FastMCP 客户端。

<Note>
Google 的 MCP 集成目前是实验性的，在 Python 和 JavaScript SDK 中可用。API 会在需要时自动调用 MCP 工具，并可以连接到本地和远程 MCP 服务器。
</Note>

<Tip>
目前，Gemini 的 MCP 支持仅访问 MCP 服务器的**工具**——它查询 `list_tools` 端点并将这些功能暴露给 AI。目前不支持其他 MCP 功能，如资源和提示。
</Tip>

### 创建服务器

首先，创建一个包含您要暴露的工具的 FastMCP 服务器。在此示例中，我们将创建一个带有掷骰子单一工具的服务器。

```python server.py
import random
from fastmcp import FastMCP

mcp = FastMCP(name="骰子投掷器")

@mcp.tool
def roll_dice(n_dice: int) -> list[int]:
    """掷 `n_dice` 个六面骰子并返回结果。"""
    return [random.randint(1, 6) for _ in range(n_dice)]

if __name__ == "__main__":
    mcp.run()
```

### 调用服务器


要将 Gemini API 与 MCP 一起使用，您需要安装 Google Generative AI SDK：

```bash
pip install google-genai
```

您还需要通过 Google 进行身份验证。您可以通过设置 `GEMINI_API_KEY` 环境变量来完成此操作。有关更多信息，请查阅 Gemini SDK 文档。

```bash
export GEMINI_API_KEY="your-api-key"
```

Gemini 的 SDK 直接与 MCP 客户端会话交互。要调用服务器，您需要实例化一个 FastMCP 客户端，进入其连接上下文，并将客户端会话传递给 Gemini SDK。

```python {5, 9, 15}
from fastmcp import Client
from google import genai
import asyncio

mcp_client = Client("server.py")
gemini_client = genai.Client()

async def main():    
    async with mcp_client:
        response = await gemini_client.aio.models.generate_content(
            model="gemini-2.0-flash",
            contents="投掷 3 个骰子！",
            config=genai.types.GenerateContentConfig(
                temperature=0,
                tools=[mcp_client.session],  # 传递 FastMCP 客户端会话
            ),
        )
        print(response.text)

if __name__ == "__main__":
    asyncio.run(main())
```

如果您运行此代码，您将看到类似以下的输出：

```text
好的，我投掷了 3 个骰子，得到了 5、4 和 1。
```

### 远程和身份验证服务器

在上面的示例中，我们使用 `stdio` 传输连接到本地服务器。由于我们使用的是 FastMCP 客户端，您还可以连接到任何本地或远程 MCP 服务器，使用 FastMCP 支持的任何[传输](/zh/clients/transports)或[身份验证](/zh/clients/auth)方法，只需更改客户端配置即可。

例如，要连接到远程的经过身份验证的服务器，您可以使用以下客户端：

```python
from fastmcp import Client
from fastmcp.client.auth import BearerAuth

mcp_client = Client(
    "https://my-server.com/mcp/",
    auth=BearerAuth("<your-token>"),
)
```

其余代码保持不变。


