---
title: Scalekit ğŸ¤ FastMCP
sidebarTitle: Scalekit
description: ä½¿ç”¨ Scalekit ä¿æŠ¤æ‚¨çš„ FastMCP æœåŠ¡å™¨
icon: shield-check
tag: NEW
---

import { VersionBadge } from "/snippets/version-badge.mdx"

<VersionBadge version="2.12.5" />


ä½¿ç”¨ [Remote OAuth](/servers/auth/remote-oauth) æ¨¡å¼é€šè¿‡ [Scalekit](https://scalekit.com) ä¸ºæ‚¨çš„ FastMCP æœåŠ¡å™¨å®‰è£…èº«ä»½éªŒè¯æ ˆï¼šScalekit å¤„ç†ç”¨æˆ·èº«ä»½éªŒè¯ï¼ŒMCP æœåŠ¡å™¨éªŒè¯å·²é¢å‘çš„ä»¤ç‰Œã€‚

## é…ç½®

### å…ˆå†³æ¡ä»¶

å¼€å§‹ä¹‹å‰

1. è·å– [Scalekit è´¦æˆ·](https://app.scalekit.com/) å¹¶ä» _Dashboard > Developers > Settings_ è·å– API å‡­æ®ï¼Œå¦‚ **Client ID**ã€**Client Secret** å’Œ **Environment URL**ã€‚
2. å‡†å¤‡å¥½æ‚¨çš„ FastMCP æœåŠ¡å™¨ç«¯ç‚¹ï¼ˆå¯ä»¥æ˜¯ç”¨äºå¼€å‘çš„ localhostï¼Œä¾‹å¦‚ `http://localhost:8000/mcp`ï¼‰

### æ­¥éª¤ 1ï¼šåœ¨ Scalekit ç¯å¢ƒä¸­é…ç½® MCP æœåŠ¡å™¨

<Steps>
<Step title="æ³¨å†Œ MCP æœåŠ¡å™¨å¹¶è®¾ç½®ç¯å¢ƒ">

åœ¨æ‚¨çš„ Scalekit ä»ªè¡¨æ¿ä¸­ï¼š
    1. æ‰“å¼€ **MCP Servers** éƒ¨åˆ†ï¼Œç„¶åé€‰æ‹© **Create new server**
    2. è¾“å…¥æœåŠ¡å™¨è¯¦ç»†ä¿¡æ¯ï¼šåç§°ã€èµ„æºæ ‡è¯†ç¬¦å’Œæ‰€éœ€çš„ MCP å®¢æˆ·ç«¯èº«ä»½éªŒè¯è®¾ç½®
    3. ä¿å­˜ï¼Œç„¶åå¤åˆ¶ **Resource ID**ï¼ˆä¾‹å¦‚ï¼Œres_92015146095ï¼‰

åœ¨æ‚¨çš„ FastMCP é¡¹ç›®çš„ `.env` ä¸­ï¼š

```sh
SCALEKIT_ENVIRONMENT_URL=<YOUR_APP_ENVIRONMENT_URL>
SCALEKIT_CLIENT_ID=<YOUR_APP_CLIENT_ID> # skc_7008EXAMPLE46
SCALEKIT_RESOURCE_ID=<YOUR_APP_RESOURCE_ID> # res_926EXAMPLE5878
MCP_URL=http://localhost:8000/mcp
```

</Step>
</Steps>

### æ­¥éª¤ 2ï¼šä¸º FastMCP æœåŠ¡å™¨æ·»åŠ èº«ä»½éªŒè¯

åˆ›å»ºæ‚¨çš„ FastMCP æœåŠ¡å™¨æ–‡ä»¶å¹¶ä½¿ç”¨ ScalekitProvider è‡ªåŠ¨å¤„ç†æ‰€æœ‰ OAuth é›†æˆï¼š

```python server.py
from fastmcp import FastMCP
from fastmcp.server.auth.providers.scalekit import ScalekitProvider

# å‘ç° Scalekit ç«¯ç‚¹å¹¶è®¾ç½® JWT ä»¤ç‰ŒéªŒè¯
auth_provider = ScalekitProvider(
    environment_url=SCALEKIT_ENVIRONMENT_URL,    # Scalekit ç¯å¢ƒ URL
    client_id=SCALEKIT_CLIENT_ID,                # OAuth å®¢æˆ·ç«¯ ID
    resource_id=SCALEKIT_RESOURCE_ID,            # èµ„æºæœåŠ¡å™¨ ID
    mcp_url=SERVER_URL,                          # ä¹Ÿæ˜¯ aud å£°æ˜
)

# ä½¿ç”¨èº«ä»½éªŒè¯åˆ›å»º FastMCP æœåŠ¡å™¨
mcp = FastMCP(name="My Scalekit Protected Server", auth=auth_provider)

@mcp.tool
def auth_status() -> dict:
    """æ˜¾ç¤º Scalekit èº«ä»½éªŒè¯çŠ¶æ€ã€‚"""
    # ä» JWT ä¸­æå–ç”¨æˆ·å£°æ˜
    return {
        "message": "æ­¤å·¥å…·éœ€è¦é€šè¿‡ Scalekit è¿›è¡Œèº«ä»½éªŒè¯",
        "authenticated": True,
        "provider": "Scalekit"
    }

```

## æµ‹è¯•

### å¯åŠ¨ MCP æœåŠ¡å™¨

```sh
uv run python server.py
```

ä½¿ç”¨ä»»ä½• MCP å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ï¼Œmcp-inspectorã€Claudeã€VS Code æˆ– Windsurfï¼‰è¿æ¥åˆ°æ­£åœ¨è¿è¡Œçš„æœåŠ¡å™¨ã€‚éªŒè¯èº«ä»½éªŒè¯æˆåŠŸå’Œè¯·æ±‚æŒ‰é¢„æœŸè·å¾—æˆæƒã€‚

### æä¾›ç¨‹åºé€‰æ‹©

è®¾ç½®æ­¤ç¯å¢ƒå˜é‡å…è®¸è‡ªåŠ¨ä½¿ç”¨ Scalekit æä¾›ç¨‹åºï¼Œè€Œæ— éœ€åœ¨ä»£ç ä¸­æ˜¾å¼å®ä¾‹åŒ–å®ƒã€‚

<Card>
<ParamField path="FASTMCP_SERVER_AUTH" default="Not set">
è®¾ç½®ä¸º `fastmcp.server.auth.providers.scalekit.ScalekitProvider` ä»¥ä½¿ç”¨ Scalekit èº«ä»½éªŒè¯ã€‚
</ParamField>
</Card>

### Scalekit ç‰¹å®šé…ç½®

è¿™äº›ç¯å¢ƒå˜é‡ä¸º Scalekit æä¾›ç¨‹åºæä¾›é»˜è®¤å€¼ï¼Œæ— è®ºå®ƒæ˜¯æ‰‹åŠ¨å®ä¾‹åŒ–è¿˜æ˜¯é€šè¿‡ `FASTMCP_SERVER_AUTH` é…ç½®ã€‚

<Card>
<ParamField path="FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_ENVIRONMENT_URL" required>
æ‚¨ä»ç®¡ç†é—¨æˆ·è·å–çš„ Scalekit ç¯å¢ƒ URLï¼ˆä¾‹å¦‚ï¼Œ`https://your-env.scalekit.com`ï¼‰
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_CLIENT_ID" required>
æ‚¨ä»åº”ç”¨ç¨‹åºéƒ¨åˆ†è·å–çš„ Scalekit OAuth åº”ç”¨ç¨‹åºå®¢æˆ·ç«¯ ID
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_RESOURCE_ID" required>
æ‚¨ä»èµ„æºéƒ¨åˆ†è·å–çš„ Scalekit èµ„æºæœåŠ¡å™¨ ID
</ParamField>

<ParamField path="FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_MCP_URL" required>
æ‚¨çš„ FastMCP æœåŠ¡å™¨çš„å…¬å…± URLï¼ˆä¾‹å¦‚ï¼Œ`https://your-server.com` æˆ–ç”¨äºå¼€å‘çš„ `http://localhost:8000/mcp`ï¼‰
</ParamField>
</Card>

Example `.env`:

```bash
# ä½¿ç”¨ Scalekit æä¾›ç¨‹åº
FASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.scalekit.ScalekitProvider

# Scalekit é…ç½®
FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_ENVIRONMENT_URL=https://your-env.scalekit.com
FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_CLIENT_ID=skc_123
FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_RESOURCE_ID=res_456
FASTMCP_SERVER_AUTH_SCALEKITPROVIDER_MCP_URL=https://your-server.com/mcp
```

è®¾ç½®ç¯å¢ƒå˜é‡åï¼Œæ‚¨çš„æœåŠ¡å™¨ä»£ç ç®€åŒ–ä¸ºï¼š

```python server.py
from fastmcp import FastMCP

# èº«ä»½éªŒè¯è‡ªåŠ¨ä»ç¯å¢ƒä¸­é…ç½®
mcp = FastMCP(name="My Scalekit Protected Server")

@mcp.tool
def protected_action() -> str:
    """éœ€è¦èº«ä»½éªŒè¯çš„å·¥å…·ã€‚"""
    return "é€šè¿‡ Scalekit æˆäºˆè®¿é—®æƒé™ï¼"
```

## åŠŸèƒ½

Scalekit æ”¯æŒå¸¦æœ‰åŠ¨æ€å®¢æˆ·ç«¯æ³¨å†Œçš„ OAuth 2.1ï¼Œé€‚ç”¨äº MCP å®¢æˆ·ç«¯å’Œä¼ä¸š SSOï¼Œå¹¶æä¾›å†…ç½®çš„ JWT éªŒè¯å’Œå®‰å…¨æ§åˆ¶ã€‚

**OAuth 2.1/DCR**ï¼šå®¢æˆ·ç«¯è‡ªæ³¨å†Œï¼Œä½¿ç”¨ PKCEï¼Œå¹¶ä¸ Remote OAuth æ¨¡å¼ä¸€èµ·å·¥ä½œï¼Œæ— éœ€é¢„ç½®å‡­æ®ã€‚

**éªŒè¯å’Œ SSO**ï¼šä»¤ç‰Œç»è¿‡éªŒè¯ï¼ˆå¯†é’¥ã€RS256ã€å‘è¡Œè€…ã€å—ä¼—ã€è¿‡æœŸæ—¶é—´ï¼‰ï¼Œæ”¯æŒ SAMLã€OIDCã€OAuth 2.0ã€ADFSã€Azure AD å’Œ Google Workspaceï¼›åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ HTTPS å¹¶æ ¹æ®éœ€è¦æŸ¥çœ‹èº«ä»½éªŒè¯æ—¥å¿—ã€‚

## è°ƒè¯•

å¯ç”¨è¯¦ç»†æ—¥å¿—ä»¥æ’é™¤èº«ä»½éªŒè¯é—®é¢˜ï¼š

```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

### ä»¤ç‰Œæ£€æŸ¥

æ‚¨å¯ä»¥åœ¨å·¥å…·ä¸­æ£€æŸ¥ JWT ä»¤ç‰Œä»¥äº†è§£ç”¨æˆ·ä¸Šä¸‹æ–‡ï¼š

```python
from fastmcp.server.context import request_ctx
import jwt

@mcp.tool
def inspect_token() -> dict:
    """æ£€æŸ¥å½“å‰ JWT ä»¤ç‰Œå£°æ˜ã€‚"""
    context = request_ctx.get()

    # ä» Authorization æ ‡å¤´ä¸­æå–ä»¤ç‰Œ
    if hasattr(context, 'request') and hasattr(context.request, 'headers'):
        auth_header = context.request.headers.get('authorization', '')
        if auth_header.startswith('Bearer '):
            token = auth_header[7:]
            # ä¸éªŒè¯ç­¾åè¿›è¡Œè§£ç ï¼ˆå·²ç»ç”±æä¾›ç¨‹åºéªŒè¯ï¼‰
            claims = jwt.decode(token, options={"verify_signature": False})
            return claims

    return {"error": "æœªæ‰¾åˆ°ä»¤ç‰Œ"}
```
